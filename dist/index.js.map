{"version":3,"sources":["../src/core/errors/index.ts","../src/core/http/client.ts","../src/core/resources/service-invoices.ts","../src/core/resources/companies.ts","../src/core/resources/legal-people.ts","../src/core/resources/natural-people.ts","../src/core/resources/webhooks.ts","../src/core/resources/index.ts","../src/core/client.ts","../src/index.ts"],"names":["init_client","process","ConfigurationError","NfeClient"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAA,cAAA,GAAA,EAAA;AAAA,QAAA,CAAA,cAAA,EAAA;AAAA,EAAA,QAAA,EAAA,MAAA,QAAA;AAAA,EAAA,mBAAA,EAAA,MAAA,mBAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,kBAAA,EAAA,MAAA,kBAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,YAAA,EAAA,MAAA,YAAA;AAAA,EAAA,UAAA,EAAA,MAAA,UAAA;AAAA,EAAA,mBAAA,EAAA,MAAA,mBAAA;AAAA,EAAA,sBAAA,EAAA,MAAA,sBAAA;AAAA,EAAA,QAAA,EAAA,MAAA,QAAA;AAAA,EAAA,aAAA,EAAA,MAAA,aAAA;AAAA,EAAA,mBAAA,EAAA,MAAA,mBAAA;AAAA,EAAA,cAAA,EAAA,MAAA,cAAA;AAAA,EAAA,WAAA,EAAA,MAAA,WAAA;AAAA,EAAA,YAAA,EAAA,MAAA,YAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,qBAAA,EAAA,MAAA,qBAAA;AAAA,EAAA,iBAAA,EAAA,MAAA,iBAAA;AAAA,EAAA,UAAA,EAAA,MAAA,UAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,qBAAA,EAAA,MAAA,qBAAA;AAAA,EAAA,cAAA,EAAA,MAAA,cAAA;AAAA,EAAA,iBAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AAiPO,SAAS,WAAW,KAAA,EAAmC;AAC5D,EAAA,OAAO,KAAA,YAAiB,QAAA;AAC1B;AAEO,SAAS,sBAAsB,KAAA,EAA8C;AAClF,EAAA,OAAO,KAAA,YAAiB,mBAAA;AAC1B;AAEO,SAAS,kBAAkB,KAAA,EAA0C;AAC1E,EAAA,OAAO,KAAA,YAAiB,eAAA;AAC1B;AAEO,SAAS,gBAAgB,KAAA,EAAwC;AACtE,EAAA,OAAO,KAAA,YAAiB,aAAA;AAC1B;AAEO,SAAS,kBAAkB,KAAA,EAA0C;AAC1E,EAAA,OAAO,KAAA,YAAiB,eAAA;AAC1B;AAEO,SAAS,eAAe,KAAA,EAAuC;AACpE,EAAA,OAAO,KAAA,YAAiB,YAAA;AAC1B;AAEO,SAAS,sBAAsB,KAAA,EAA8C;AAClF,EAAA,OAAO,KAAA,YAAiB,mBAAA;AAC1B;AA3QA,IAWa,QAAA,CAAA,CAuCA,mBAAA,CAAA,CAQA,eAAA,CAAA,CAQA,aAAA,CAAA,CAQA,eAQA,cAAA,CAAA,CAQA,WAAA,CAAA,CAYA,eAAA,CAAA,CAQA,YAAA,CAAA,CAYA,oBAQA,mBAAA,CAAA,CAQA,sBAAA,CAAA,CAYA,YAAA,CAAA,CA4HA,eAAA,CAAA,CAGA,UAGA,mBAAA,CAAA,CAGA;AA3Rb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,0BAAA,GAAA;AAWO,IAAM,QAAA,GAAN,cAAuB,KAAA,CAAM;AAAA,MAClB,IAAA,GAAe,UAAA;AAAA,MACf,IAAA;AAAA,MACA,OAAA;AAAA,MACA,GAAA;AAAA,MAEhB,WAAA,CAAY,OAAA,EAAiB,OAAA,EAAmB,IAAA,EAAe;AAC7D,QAAA,KAAA,CAAM,OAAO,CAAA;AACb,QAAA,IAAA,CAAK,IAAA,GAAO,KAAK,WAAA,CAAY,IAAA;AAC7B,QAAA,IAAA,CAAK,IAAA,GAAO,IAAA;AACZ,QAAA,IAAA,CAAK,OAAA,GAAU,OAAA;AACf,QAAA,IAAA,CAAK,GAAA,GAAM,OAAA;AAGX,QAAA,MAAA,CAAO,cAAA,CAAe,IAAA,EAAM,GAAA,CAAA,MAAA,CAAW,SAAS,CAAA;AAGhD,QAAA,IAAI,mBAAA,IAAuB,KAAA,IAAS,OAAQ,KAAA,CAAc,sBAAsB,UAAA,EAAY;AAC1F,UAAC,KAAA,CAAc,iBAAA,CAAkB,IAAA,EAAM,IAAA,CAAK,WAAW,CAAA;AAAA,QACzD;AAAA,MACF;AAAA;AAAA,MAGA,MAAA,GAAS;AACP,QAAA,OAAO;AAAA,UACL,MAAM,IAAA,CAAK,IAAA;AAAA,UACX,MAAM,IAAA,CAAK,IAAA;AAAA,UACX,SAAS,IAAA,CAAK,OAAA;AAAA,UACd,MAAM,IAAA,CAAK,IAAA;AAAA,UACX,SAAS,IAAA,CAAK,OAAA;AAAA,UACd,OAAO,IAAA,CAAK;AAAA,SACd;AAAA,MACF;AAAA,KACF;AAMO,IAAM,mBAAA,GAAN,cAAkC,QAAA,CAAS;AAAA,MACvB,IAAA,GAAO,qBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,0CAAA,EAA4C,OAAA,EAAmB;AACnF,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,GAAG,CAAA;AAAA,MAC7B;AAAA,KACF;AAEO,IAAM,eAAA,GAAN,cAA8B,QAAA,CAAS;AAAA,MACnB,IAAA,GAAO,iBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,sBAAA,EAAwB,OAAA,EAAmB;AAC/D,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,GAAG,CAAA;AAAA,MAC7B;AAAA,KACF;AAEO,IAAM,aAAA,GAAN,cAA4B,QAAA,CAAS;AAAA,MACjB,IAAA,GAAO,eAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,oBAAA,EAAsB,OAAA,EAAmB;AAC7D,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,GAAG,CAAA;AAAA,MAC7B;AAAA,KACF;AAEO,IAAM,aAAA,GAAN,cAA4B,QAAA,CAAS;AAAA,MACjB,IAAA,GAAO,eAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,mBAAA,EAAqB,OAAA,EAAmB;AAC5D,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,GAAG,CAAA;AAAA,MAC7B;AAAA,KACF;AAEO,IAAM,cAAA,GAAN,cAA6B,QAAA,CAAS;AAAA,MAClB,IAAA,GAAO,gBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,qBAAA,EAAuB,OAAA,EAAmB;AAC9D,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,GAAG,CAAA;AAAA,MAC7B;AAAA,KACF;AAEO,IAAM,WAAA,GAAN,cAA0B,QAAA,CAAS;AAAA,MACf,IAAA,GAAO,aAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,uBAAA,EAAyB,OAAA,EAAmB,OAAO,GAAA,EAAK;AAC5E,QAAA,KAAA,CAAM,OAAA,EAAS,SAAS,IAAI,CAAA;AAAA,MAC9B;AAAA,KACF;AAMO,IAAM,eAAA,GAAN,cAA8B,QAAA,CAAS;AAAA,MACnB,IAAA,GAAO,iBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,kBAAA,EAAoB,OAAA,EAAmB;AAC3D,QAAA,KAAA,CAAM,SAAS,OAAO,CAAA;AAAA,MACxB;AAAA,KACF;AAEO,IAAM,YAAA,GAAN,cAA2B,QAAA,CAAS;AAAA,MAChB,IAAA,GAAO,cAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,iBAAA,EAAmB,OAAA,EAAmB;AAC1D,QAAA,KAAA,CAAM,SAAS,OAAO,CAAA;AAAA,MACxB;AAAA,KACF;AAMO,IAAM,kBAAA,GAAN,cAAiC,QAAA,CAAS;AAAA,MACtB,IAAA,GAAO,oBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,yBAAA,EAA2B,OAAA,EAAmB;AAClE,QAAA,KAAA,CAAM,SAAS,OAAO,CAAA;AAAA,MACxB;AAAA,KACF;AAEO,IAAM,mBAAA,GAAN,cAAkC,QAAA,CAAS;AAAA,MACvB,IAAA,GAAO,qBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,+CAAA,EAAiD,OAAA,EAAmB;AACxF,QAAA,KAAA,CAAM,SAAS,OAAO,CAAA;AAAA,MACxB;AAAA,KACF;AAEO,IAAM,sBAAA,GAAN,cAAqC,QAAA,CAAS;AAAA,MAC1B,IAAA,GAAO,wBAAA;AAAA,MAEhC,WAAA,CAAY,OAAA,GAAU,2BAAA,EAA6B,OAAA,EAAmB;AACpE,QAAA,KAAA,CAAM,SAAS,OAAO,CAAA;AAAA,MACxB;AAAA,KACF;AAMO,IAAM,eAAN,MAAmB;AAAA;AAAA;AAAA;AAAA,MAIxB,OAAO,gBAAA,CAAiB,MAAA,EAAgB,IAAA,EAAgB,OAAA,EAA4B;AAClF,QAAA,MAAM,YAAA,GAAe,OAAA,IAAW,IAAA,CAAK,iBAAA,CAAkB,MAAM,CAAA;AAE7D,QAAA,QAAQ,MAAA;AAAQ,UACd,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,eAAA,CAAgB,YAAA,EAAc,IAAI,CAAA;AAAA,UAC/C,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,mBAAA,CAAoB,YAAA,EAAc,IAAI,CAAA;AAAA,UACnD,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,aAAA,CAAc,YAAA,EAAc,IAAI,CAAA;AAAA,UAC7C,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,aAAA,CAAc,YAAA,EAAc,IAAI,CAAA;AAAA,UAC7C,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,cAAA,CAAe,YAAA,EAAc,IAAI,CAAA;AAAA,UAC9C,KAAK,GAAA;AAAA,UACL,KAAK,GAAA;AAAA,UACL,KAAK,GAAA;AAAA,UACL,KAAK,GAAA;AACH,YAAA,OAAO,IAAI,WAAA,CAAY,YAAA,EAAc,IAAA,EAAM,MAAM,CAAA;AAAA,UACnD;AACE,YAAA,IAAI,MAAA,IAAU,GAAA,IAAO,MAAA,GAAS,GAAA,EAAK;AACjC,cAAA,OAAO,IAAI,eAAA,CAAgB,YAAA,EAAc,IAAI,CAAA;AAAA,YAC/C;AACA,YAAA,IAAI,UAAU,GAAA,EAAK;AACjB,cAAA,OAAO,IAAI,WAAA,CAAY,YAAA,EAAc,IAAA,EAAM,MAAM,CAAA;AAAA,YACnD;AACA,YAAA,OAAO,IAAI,QAAA,CAAS,YAAA,EAAc,IAAA,EAAM,MAAM,CAAA;AAAA;AAClD,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,OAAO,iBAAiB,KAAA,EAAwB;AAC9C,QAAA,IAAI,MAAM,IAAA,KAAS,YAAA,IAAgB,MAAM,OAAA,CAAQ,QAAA,CAAS,SAAS,CAAA,EAAG;AACpE,UAAA,OAAO,IAAI,YAAA,CAAa,iBAAA,EAAmB,KAAK,CAAA;AAAA,QAClD;AAEA,QAAA,IAAI,KAAA,CAAM,OAAA,CAAQ,QAAA,CAAS,OAAO,CAAA,EAAG;AACnC,UAAA,OAAO,IAAI,eAAA,CAAgB,2BAAA,EAA6B,KAAK,CAAA;AAAA,QAC/D;AAEA,QAAA,OAAO,IAAI,eAAA,CAAgB,kBAAA,EAAoB,KAAK,CAAA;AAAA,MACtD;AAAA;AAAA;AAAA;AAAA,MAKA,OAAO,qBAAqB,WAAA,EAAyC;AACnE,QAAA,OAAO,IAAI,kBAAA;AAAA,UACT,mFAAmF,WAAW,CAAA,CAAA;AAAA,UAC9F,EAAE,WAAA,EAAa,eAAA,EAAiB,UAAA;AAAW,SAC7C;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,OAAO,iBAAA,GAAwC;AAC7C,QAAA,OAAO,IAAI,kBAAA;AAAA,UACT,oFAAA;AAAA,UACA,EAAE,aAAa,QAAA;AAAS,SAC1B;AAAA,MACF;AAAA,MAEA,OAAe,kBAAkB,MAAA,EAAwB;AACvD,QAAA,MAAM,QAAA,GAAmC;AAAA,UACvC,GAAA,EAAK,sBAAA;AAAA,UACL,GAAA,EAAK,0CAAA;AAAA,UACL,GAAA,EAAK,kBAAA;AAAA,UACL,GAAA,EAAK,oBAAA;AAAA,UACL,GAAA,EAAK,mBAAA;AAAA,UACL,GAAA,EAAK,qBAAA;AAAA,UACL,GAAA,EAAK,uBAAA;AAAA,UACL,GAAA,EAAK,aAAA;AAAA,UACL,GAAA,EAAK,qBAAA;AAAA,UACL,GAAA,EAAK;AAAA,SACP;AAEA,QAAA,OAAO,QAAA,CAAS,MAAM,CAAA,IAAK,CAAA,KAAA,EAAQ,MAAM,CAAA,MAAA,CAAA;AAAA,MAC3C;AAAA,KACF;AAuCO,IAAM,eAAA,GAAkB,eAAA;AAGxB,IAAM,QAAA,GAAW,QAAA;AAGjB,IAAM,mBAAA,GAAsB,WAAA;AAG5B,IAAM,UAAA,GAAa;AAAA,MACxB,QAAA;AAAA,MACA,mBAAA;AAAA,MACA,eAAA;AAAA,MACA,aAAA;AAAA,MACA,aAAA;AAAA,MACA,cAAA;AAAA,MACA,WAAA;AAAA,MACA,eAAA;AAAA,MACA,YAAA;AAAA,MACA,kBAAA;AAAA,MACA,mBAAA;AAAA,MACA,sBAAA;AAAA;AAAA,MAEA,eAAA;AAAA,MACA,QAAA;AAAA,MACA;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC2EO,SAAS,wBAAA,GAAwC;AACtD,EAAA,OAAO;AAAA,IACL,UAAA,EAAY,CAAA;AAAA,IACZ,SAAA,EAAW,GAAA;AAAA,IACX,QAAA,EAAU,GAAA;AAAA,IACV,iBAAA,EAAmB;AAAA,GACrB;AACF;AAKO,SAAS,eAAA,CAAgB,MAAA,EAAgB,OAAA,EAAiB,OAAA,EAAiB,WAAA,EAAsC;AACtH,EAAA,OAAO;AAAA,IACL,MAAA;AAAA,IACA,OAAA;AAAA,IACA,OAAA;AAAA,IACA;AAAA,GACF;AACF;AA1YA,IA8Ba,UAAA;AA9Bb,IAAA,WAAA,GAAA,KAAA,CAAA;AAAA,EAAA,yBAAA,GAAA;AAQA,IAAA,WAAA,EAAA;AAsBO,IAAM,aAAN,MAAiB;AAAA,MACL,MAAA;AAAA,MAEjB,YAAY,MAAA,EAAoB;AAC9B,QAAA,IAAA,CAAK,MAAA,GAAS,MAAA;AACd,QAAA,IAAA,CAAK,oBAAA,EAAqB;AAAA,MAC5B;AAAA;AAAA;AAAA;AAAA,MAMA,MAAM,GAAA,CAAiB,IAAA,EAAc,MAAA,EAA4D;AAC/F,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,QAAA,CAAS,IAAA,EAAM,MAAM,CAAA;AACtC,QAAA,OAAO,IAAA,CAAK,OAAA,CAAW,KAAA,EAAO,GAAG,CAAA;AAAA,MACnC;AAAA,MAEA,MAAM,IAAA,CAAkB,IAAA,EAAc,IAAA,EAA0C;AAC9E,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,QAAA,CAAS,IAAI,CAAA;AAC9B,QAAA,OAAO,IAAA,CAAK,OAAA,CAAW,MAAA,EAAQ,GAAA,EAAK,IAAI,CAAA;AAAA,MAC1C;AAAA,MAEA,MAAM,GAAA,CAAiB,IAAA,EAAc,IAAA,EAA0C;AAC7E,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,QAAA,CAAS,IAAI,CAAA;AAC9B,QAAA,OAAO,IAAA,CAAK,OAAA,CAAW,KAAA,EAAO,GAAA,EAAK,IAAI,CAAA;AAAA,MACzC;AAAA,MAEA,MAAM,OAAoB,IAAA,EAAwC;AAChE,QAAA,MAAM,GAAA,GAAM,IAAA,CAAK,QAAA,CAAS,IAAI,CAAA;AAC9B,QAAA,OAAO,IAAA,CAAK,OAAA,CAAW,QAAA,EAAU,GAAG,CAAA;AAAA,MACtC;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,OAAA,CACZ,MAAA,EACA,GAAA,EACA,IAAA,EAC0B;AAC1B,QAAA,MAAM,EAAE,UAAA,EAAY,SAAA,EAAU,GAAI,KAAK,MAAA,CAAO,WAAA;AAC9C,QAAA,IAAI,SAAA;AAEJ,QAAA,KAAA,IAAS,OAAA,GAAU,CAAA,EAAG,OAAA,IAAW,UAAA,EAAY,OAAA,EAAA,EAAW;AACtD,UAAA,IAAI;AACF,YAAA,MAAM,WAAW,MAAM,IAAA,CAAK,cAAA,CAAkB,MAAA,EAAQ,KAAK,IAAI,CAAA;AAC/D,YAAA,OAAO,QAAA;AAAA,UACT,SAAS,KAAA,EAAO;AACd,YAAA,SAAA,GAAY,KAAA;AAGZ,YAAA,IAAI,IAAA,CAAK,cAAA,CAAe,SAAA,EAAW,OAAA,EAAS,UAAU,CAAA,EAAG;AACvD,cAAA,MAAM,SAAA;AAAA,YACR;AAGA,YAAA,IAAI,UAAU,UAAA,EAAY;AACxB,cAAA,MAAM,KAAA,GAAQ,IAAA,CAAK,mBAAA,CAAoB,OAAA,EAAS,SAAS,CAAA;AACzD,cAAA,MAAM,IAAA,CAAK,MAAM,KAAK,CAAA;AAAA,YACxB;AAAA,UACF;AAAA,QACF;AAEA,QAAA,MAAM,SAAA,IAAa,IAAI,eAAA,CAAgB,kCAAkC,CAAA;AAAA,MAC3E;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,cAAA,CACZ,MAAA,EACA,GAAA,EACA,IAAA,EAC0B;AAC1B,QAAA,MAAM,UAAA,GAAa,IAAI,eAAA,EAAgB;AACvC,QAAA,MAAM,SAAA,GAAY,WAAW,MAAM,UAAA,CAAW,OAAM,EAAG,IAAA,CAAK,OAAO,OAAO,CAAA;AAE1E,QAAA,IAAI;AACF,UAAA,MAAM,OAAA,GAAU,IAAA,CAAK,YAAA,CAAa,IAAI,CAAA;AACtC,UAAA,MAAM,IAAA,GAAO,IAAA,CAAK,SAAA,CAAU,IAAI,CAAA;AAEhC,UAAA,MAAM,QAAA,GAAW,MAAM,KAAA,CAAM,GAAA,EAAK;AAAA,YAChC,MAAA,EAAQ,OAAO,WAAA,EAAY;AAAA,YAC3B,OAAA;AAAA,YACA,IAAA;AAAA,YACA,QAAQ,UAAA,CAAW;AAAA,WACpB,CAAA;AAED,UAAA,YAAA,CAAa,SAAS,CAAA;AAEtB,UAAA,OAAO,MAAM,IAAA,CAAK,eAAA,CAAmB,QAAQ,CAAA;AAAA,QAE/C,SAAS,KAAA,EAAO;AACd,UAAA,YAAA,CAAa,SAAS,CAAA;AAEtB,UAAA,IAAI,iBAAiB,KAAA,EAAO;AAC1B,YAAA,IAAI,KAAA,CAAM,SAAS,YAAA,EAAc;AAC/B,cAAA,MAAM,IAAI,YAAA,CAAa,CAAA,sBAAA,EAAyB,KAAK,MAAA,CAAO,OAAO,MAAM,KAAK,CAAA;AAAA,YAChF;AACA,YAAA,MAAM,YAAA,CAAa,iBAAiB,KAAK,CAAA;AAAA,UAC3C;AAEA,UAAA,MAAM,IAAI,eAAA,CAAgB,uBAAA,EAAyB,KAAK,CAAA;AAAA,QAC1D;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,gBAAmB,QAAA,EAAyC;AAExE,QAAA,IAAI,QAAA,CAAS,WAAW,GAAA,EAAK;AAC3B,UAAA,MAAM,QAAA,GAAW,QAAA,CAAS,OAAA,CAAQ,GAAA,CAAI,UAAU,CAAA;AAChD,UAAA,IAAI,QAAA,EAAU;AACZ,YAAA,OAAO;AAAA,cACL,IAAA,EAAM;AAAA,gBACJ,IAAA,EAAM,GAAA;AAAA,gBACN,MAAA,EAAQ,SAAA;AAAA,gBACR;AAAA,eACF;AAAA,cACA,QAAQ,QAAA,CAAS,MAAA;AAAA,cACjB,OAAA,EAAS,IAAA,CAAK,cAAA,CAAe,QAAQ;AAAA,aACvC;AAAA,UACF;AAAA,QACF;AAGA,QAAA,IAAI,CAAC,SAAS,EAAA,EAAI;AAChB,UAAA,MAAM,IAAA,CAAK,oBAAoB,QAAQ,CAAA;AAAA,QACzC;AAGA,QAAA,MAAM,IAAA,GAAO,MAAM,IAAA,CAAK,iBAAA,CAAqB,QAAQ,CAAA;AAErD,QAAA,OAAO;AAAA,UACL,IAAA;AAAA,UACA,QAAQ,QAAA,CAAS,MAAA;AAAA,UACjB,OAAA,EAAS,IAAA,CAAK,cAAA,CAAe,QAAQ;AAAA,SACvC;AAAA,MACF;AAAA,MAEA,MAAc,kBAAqB,QAAA,EAA2B;AAC5D,QAAA,MAAM,WAAA,GAAc,QAAA,CAAS,OAAA,CAAQ,GAAA,CAAI,cAAc,CAAA,IAAK,EAAA;AAE5D,QAAA,IAAI,WAAA,CAAY,QAAA,CAAS,kBAAkB,CAAA,EAAG;AAC5C,UAAA,OAAO,SAAS,IAAA,EAAK;AAAA,QACvB;AAEA,QAAA,IAAI,YAAY,QAAA,CAAS,iBAAiB,KAAK,WAAA,CAAY,QAAA,CAAS,iBAAiB,CAAA,EAAG;AACtF,UAAA,MAAM,MAAA,GAAS,MAAM,QAAA,CAAS,WAAA,EAAY;AAC1C,UAAA,OAAO,MAAA,CAAO,KAAK,MAAM,CAAA;AAAA,QAC3B;AAGA,QAAA,OAAO,SAAS,IAAA,EAAK;AAAA,MACvB;AAAA,MAEA,MAAc,oBAAoB,QAAA,EAA+B;AAC/D,QAAA,IAAI,SAAA;AAEJ,QAAA,IAAI;AACF,UAAA,MAAM,WAAA,GAAc,QAAA,CAAS,OAAA,CAAQ,GAAA,CAAI,cAAc,CAAA,IAAK,EAAA;AAC5D,UAAA,IAAI,WAAA,CAAY,QAAA,CAAS,kBAAkB,CAAA,EAAG;AAC5C,YAAA,SAAA,GAAY,MAAM,SAAS,IAAA,EAAK;AAAA,UAClC,CAAA,MAAO;AACL,YAAA,SAAA,GAAY,MAAM,SAAS,IAAA,EAAK;AAAA,UAClC;AAAA,QACF,CAAA,CAAA,MAAQ;AAEN,UAAA,SAAA,GAAY,EAAE,MAAA,EAAQ,QAAA,CAAS,MAAA,EAAQ,UAAA,EAAY,SAAS,UAAA,EAAW;AAAA,QACzE;AAGA,QAAA,MAAM,OAAA,GAAU,IAAA,CAAK,mBAAA,CAAoB,SAAA,EAAW,SAAS,MAAM,CAAA;AAEnE,QAAA,MAAM,YAAA,CAAa,gBAAA,CAAiB,QAAA,CAAS,MAAA,EAAQ,WAAW,OAAO,CAAA;AAAA,MACzE;AAAA,MAEQ,mBAAA,CAAoB,MAAe,MAAA,EAAwB;AACjE,QAAA,IAAI,OAAO,IAAA,KAAS,QAAA,IAAY,IAAA,KAAS,IAAA,EAAM;AAC7C,UAAA,MAAM,QAAA,GAAW,IAAA;AAGjB,UAAA,IAAI,OAAO,QAAA,CAAS,OAAA,KAAY,QAAA,SAAiB,QAAA,CAAS,OAAA;AAC1D,UAAA,IAAI,OAAO,QAAA,CAAS,KAAA,KAAU,QAAA,SAAiB,QAAA,CAAS,KAAA;AACxD,UAAA,IAAI,OAAO,QAAA,CAAS,MAAA,KAAW,QAAA,SAAiB,QAAA,CAAS,MAAA;AACzD,UAAA,IAAI,OAAO,QAAA,CAAS,OAAA,KAAY,QAAA,SAAiB,QAAA,CAAS,OAAA;AAAA,QAC5D;AAEA,QAAA,IAAI,OAAO,SAAS,QAAA,EAAU;AAC5B,UAAA,OAAO,IAAA;AAAA,QACT;AAEA,QAAA,OAAO,QAAQ,MAAM,CAAA,MAAA,CAAA;AAAA,MACvB;AAAA;AAAA;AAAA;AAAA,MAMQ,QAAA,CAAS,MAAc,MAAA,EAA0C;AACvE,QAAA,MAAM,UAAU,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,OAAA,CAAQ,OAAO,EAAE,CAAA;AACrD,QAAA,MAAM,SAAA,GAAY,IAAA,CAAK,OAAA,CAAQ,KAAA,EAAO,EAAE,CAAA;AACxC,QAAA,IAAI,GAAA,GAAM,CAAA,EAAG,OAAO,CAAA,CAAA,EAAI,SAAS,CAAA,CAAA;AAEjC,QAAA,IAAI,UAAU,MAAA,CAAO,IAAA,CAAK,MAAM,CAAA,CAAE,SAAS,CAAA,EAAG;AAC5C,UAAA,MAAM,YAAA,GAAe,IAAI,eAAA,EAAgB;AACzC,UAAA,KAAA,MAAW,CAAC,GAAA,EAAK,KAAK,KAAK,MAAA,CAAO,OAAA,CAAQ,MAAM,CAAA,EAAG;AACjD,YAAA,IAAI,KAAA,KAAU,MAAA,IAAa,KAAA,KAAU,IAAA,EAAM;AACzC,cAAA,YAAA,CAAa,MAAA,CAAO,GAAA,EAAK,MAAA,CAAO,KAAK,CAAC,CAAA;AAAA,YACxC;AAAA,UACF;AACA,UAAA,MAAM,WAAA,GAAc,aAAa,QAAA,EAAS;AAC1C,UAAA,IAAI,WAAA,EAAa;AACf,YAAA,GAAA,IAAO,IAAI,WAAW,CAAA,CAAA;AAAA,UACxB;AAAA,QACF;AAEA,QAAA,OAAO,GAAA;AAAA,MACT;AAAA,MAEQ,aAAa,IAAA,EAAwC;AAC3D,QAAA,MAAM,OAAA,GAAkC;AAAA,UACtC,eAAA,EAAiB,CAAA,MAAA,EAAS,MAAA,CAAO,IAAA,CAAK,IAAA,CAAK,OAAO,MAAM,CAAA,CAAE,QAAA,CAAS,QAAQ,CAAC,CAAA,CAAA;AAAA,UAC5E,QAAA,EAAU,kBAAA;AAAA,UACV,YAAA,EAAc,KAAK,YAAA;AAAa,SAClC;AAGA,QAAA,IAAI,IAAA,KAAS,UAAa,IAAA,KAAS,IAAA,IAAQ,CAAC,IAAA,CAAK,UAAA,CAAW,IAAI,CAAA,EAAG;AACjE,UAAA,OAAA,CAAQ,cAAc,CAAA,GAAI,kBAAA;AAAA,QAC5B;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA,MAEQ,UAAU,IAAA,EAA0C;AAC1D,QAAA,IAAI,IAAA,KAAS,MAAA,IAAa,IAAA,KAAS,IAAA,EAAM;AACvC,UAAA,OAAO,MAAA;AAAA,QACT;AAGA,QAAA,IAAI,IAAA,CAAK,UAAA,CAAW,IAAI,CAAA,EAAG;AACzB,UAAA,OAAO,IAAA;AAAA,QACT;AAGA,QAAA,OAAO,IAAA,CAAK,UAAU,IAAI,CAAA;AAAA,MAC5B;AAAA,MAEQ,WAAW,IAAA,EAAwB;AACzC,QAAA,OAAO,OAAO,QAAA,KAAa,WAAA,IAAe,IAAA,YAAgB,QAAA;AAAA,MAC5D;AAAA,MAEQ,YAAA,GAAuB;AAC7B,QAAA,MAAM,cAAc,OAAA,CAAQ,OAAA;AAC5B,QAAA,MAAM,WAAW,OAAA,CAAQ,QAAA;AAGzB,QAAA,MAAM,cAAA,GAAiB,cAAA;AAEvB,QAAA,OAAO,CAAA,YAAA,EAAe,cAAc,CAAA,MAAA,EAAS,WAAW,KAAK,QAAQ,CAAA,CAAA,CAAA;AAAA,MACvE;AAAA,MAEQ,eAAe,QAAA,EAAuC;AAC5D,QAAA,MAAM,UAAkC,EAAC;AACzC,QAAA,QAAA,CAAS,OAAA,CAAQ,OAAA,CAAQ,CAAC,KAAA,EAAY,GAAA,KAAa;AACjD,UAAA,OAAA,CAAQ,GAAG,CAAA,GAAI,KAAA;AAAA,QACjB,CAAC,CAAA;AACD,QAAA,OAAO,OAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAMQ,cAAA,CAAe,KAAA,EAAiB,OAAA,EAAiB,UAAA,EAA6B;AAEpF,QAAA,IAAI,WAAW,UAAA,EAAY;AACzB,UAAA,OAAO,IAAA;AAAA,QACT;AAGA,QAAA,IAAI,iBAAiB,cAAA,EAAgB;AACnC,UAAA,OAAO,KAAA;AAAA,QACT;AAGA,QAAA,IAAI,MAAM,IAAA,IAAQ,KAAA,CAAM,QAAQ,GAAA,IAAO,KAAA,CAAM,OAAO,GAAA,EAAK;AACvD,UAAA,OAAO,IAAA;AAAA,QACT;AAGA,QAAA,OAAO,KAAA;AAAA,MACT;AAAA,MAEQ,mBAAA,CAAoB,SAAiB,SAAA,EAA2B;AACtE,QAAA,MAAM,EAAE,QAAA,GAAW,GAAA,EAAO,oBAAoB,CAAA,EAAE,GAAI,KAAK,MAAA,CAAO,WAAA;AAGhE,QAAA,MAAM,gBAAA,GAAmB,SAAA,GAAY,IAAA,CAAK,GAAA,CAAI,mBAAmB,OAAO,CAAA;AACxE,QAAA,MAAM,MAAA,GAAS,IAAA,CAAK,MAAA,EAAO,GAAI,GAAA,GAAM,gBAAA;AAErC,QAAA,OAAO,IAAA,CAAK,GAAA,CAAI,gBAAA,GAAmB,MAAA,EAAQ,QAAQ,CAAA;AAAA,MACrD;AAAA,MAEQ,MAAM,EAAA,EAA2B;AACvC,QAAA,OAAO,IAAI,OAAA,CAAQ,CAAA,OAAA,KAAW,UAAA,CAAW,OAAA,EAAS,EAAE,CAAC,CAAA;AAAA,MACvD;AAAA;AAAA;AAAA;AAAA,MAMQ,oBAAA,GAA6B;AACnC,QAAA,IAAI,OAAO,UAAU,WAAA,EAAa;AAChC,UAAA,MAAM,YAAA,CAAa,oBAAA,CAAqB,OAAA,CAAQ,OAAO,CAAA;AAAA,QACzD;AAEA,QAAA,IAAI,OAAO,oBAAoB,WAAA,EAAa;AAC1C,UAAA,MAAM,IAAI,eAAA;AAAA,YACR;AAAA,WACF;AAAA,QACF;AAAA,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACtWA,IAqBa,uBAAA;AArBb,IAAA,qBAAA,GAAA,KAAA,CAAA;AAAA,EAAA,wCAAA,GAAA;AAeA,IAAA,WAAA,EAAA;AAMO,IAAM,0BAAN,MAA8B;AAAA,MACnC,YAA6B,IAAA,EAAkB;AAAlB,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,MAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUhD,MAAM,MAAA,CACJ,SAAA,EACA,IAAA,EACyC;AACzC,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,gBAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA,CAAqC,MAAM,IAAI,CAAA;AAEhF,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,IAAA,CACJ,SAAA,EACA,OAAA,GAA6B,EAAC,EACS;AACvC,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,gBAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAAkC,MAAM,OAAO,CAAA;AAEhF,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,QAAA,CAAS,SAAA,EAAmB,SAAA,EAA4C;AAC5E,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,SAAS,CAAA,CAAA;AACjE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAoB,IAAI,CAAA;AAEzD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,MAAA,CAAO,SAAA,EAAmB,SAAA,EAA4C;AAC1E,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,SAAS,CAAA,CAAA;AACjE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,OAAuB,IAAI,CAAA;AAE5D,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,SAAA,CAAU,SAAA,EAAmB,SAAA,EAAiE;AAClG,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,SAAS,CAAA,UAAA,CAAA;AACjE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAyC,IAAI,CAAA;AAE9E,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,WAAA,CAAY,SAAA,EAAmB,SAAA,EAAkC;AACrE,QAAA,IAAI,IAAA;AAEJ,QAAA,IAAI,SAAA,EAAW;AACb,UAAA,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,SAAS,CAAA,IAAA,CAAA;AAAA,QAC7D,CAAA,MAAO;AAEL,UAAA,IAAA,GAAO,cAAc,SAAS,CAAA,oBAAA,CAAA;AAAA,QAChC;AAEA,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAS,IAAI,CAAA;AAC9C,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,WAAA,CAAY,SAAA,EAAmB,SAAA,EAAkC;AACrE,QAAA,IAAI,IAAA;AAEJ,QAAA,IAAI,SAAA,EAAW;AACb,UAAA,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,iBAAA,EAAoB,SAAS,CAAA,IAAA,CAAA;AAAA,QAC7D,CAAA,MAAO;AAEL,UAAA,IAAA,GAAO,cAAc,SAAS,CAAA,oBAAA,CAAA;AAAA,QAChC;AAEA,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAS,IAAI,CAAA;AAC9C,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,aAAA,CACJ,SAAA,EACA,IAAA,EACA,OAAA,GAII,EAAC,EACoB;AACzB,QAAA,MAAM,EAAE,WAAA,GAAc,EAAA,EAAI,aAAa,GAAA,EAAM,SAAA,GAAY,KAAM,GAAI,OAAA;AAGnE,QAAA,MAAM,YAAA,GAAe,MAAM,IAAA,CAAK,MAAA,CAAO,WAAW,IAAI,CAAA;AAGtD,QAAA,IAAI,IAAA,IAAQ,YAAA,IAAgB,YAAA,CAAa,EAAA,EAAI;AAC3C,UAAA,OAAO,YAAA;AAAA,QACT;AAGA,QAAA,MAAM,WAAA,GAAc,YAAA;AACpB,QAAA,IAAI,WAAA,CAAY,IAAA,KAAS,GAAA,IAAO,CAAC,YAAY,QAAA,EAAU;AACrD,UAAA,MAAM,IAAI,sBAAA;AAAA,YACR,2CAAA;AAAA,YACA;AAAA,WACF;AAAA,QACF;AAGA,QAAA,OAAO,IAAA,CAAK,qBAAA,CAAsB,WAAA,CAAY,QAAA,EAAU;AAAA,UACtD,WAAA;AAAA,UACA,UAAA;AAAA,UACA;AAAA,SACD,CAAA;AAAA,MACH;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,SAAA,CAAU,SAAA,EAAmB,SAAA,EAKhC;AACD,QAAA,MAAM,OAAA,GAAU,MAAM,IAAA,CAAK,QAAA,CAAS,WAAW,SAAS,CAAA;AAExD,QAAA,OAAO;AAAA,UACL,QAAQ,OAAA,CAAQ,MAAA;AAAA,UAChB,OAAA;AAAA,UACA,YAAY,CAAC,QAAA,EAAU,WAAW,CAAA,CAAE,QAAA,CAAS,QAAQ,MAAM,CAAA;AAAA,UAC3D,QAAA,EAAU,CAAC,QAAA,EAAU,WAAA,EAAa,OAAO,CAAA,CAAE,QAAA,CAAS,QAAQ,MAAM;AAAA,SACpE;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,WAAA,CACJ,SAAA,EACA,QAAA,EACA,OAAA,GAGI,EAAC,EAC2C;AAChD,QAAA,MAAM,EAAE,iBAAA,GAAoB,KAAA,EAAO,aAAA,GAAgB,GAAE,GAAI,OAAA;AAGzD,QAAA,MAAM,UAAiD,EAAC;AAExD,QAAA,KAAA,IAAS,IAAI,CAAA,EAAG,CAAA,GAAI,QAAA,CAAS,MAAA,EAAQ,KAAK,aAAA,EAAe;AACvD,UAAA,MAAM,KAAA,GAAQ,QAAA,CAAS,KAAA,CAAM,CAAA,EAAG,IAAI,aAAa,CAAA;AAEjD,UAAA,MAAM,aAAA,GAAgB,KAAA,CAAM,GAAA,CAAI,OAAO,WAAA,KAAgB;AACrD,YAAA,IAAI,iBAAA,EAAmB;AACrB,cAAA,OAAO,IAAA,CAAK,aAAA,CAAc,SAAA,EAAW,WAAW,CAAA;AAAA,YAClD,CAAA,MAAO;AACL,cAAA,OAAO,IAAA,CAAK,MAAA,CAAO,SAAA,EAAW,WAAW,CAAA;AAAA,YAC3C;AAAA,UACF,CAAC,CAAA;AAED,UAAA,MAAM,YAAA,GAAe,MAAM,OAAA,CAAQ,GAAA,CAAI,aAAa,CAAA;AACpD,UAAA,OAAA,CAAQ,IAAA,CAAK,GAAG,YAAY,CAAA;AAAA,QAC9B;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAMA,MAAc,qBAAA,CACZ,WAAA,EACA,OAAA,EACyB;AACzB,QAAA,MAAM,EAAE,WAAA,EAAa,UAAA,EAAY,SAAA,EAAU,GAAI,OAAA;AAC/C,QAAA,MAAM,SAAA,GAAY,KAAK,GAAA,EAAI;AAE3B,QAAA,KAAA,IAAS,OAAA,GAAU,CAAA,EAAG,OAAA,GAAU,WAAA,EAAa,OAAA,EAAA,EAAW;AAEtD,UAAA,IAAI,IAAA,CAAK,GAAA,EAAI,GAAI,SAAA,GAAY,SAAA,EAAW;AACtC,YAAA,MAAM,IAAI,sBAAA;AAAA,cACR,oCAAoC,SAAS,CAAA,EAAA,CAAA;AAAA,cAC7C,EAAE,WAAA,EAAa,OAAA,EAAS,SAAA;AAAU,aACpC;AAAA,UACF;AAGA,UAAA,IAAI,UAAU,CAAA,EAAG;AACf,YAAA,MAAM,IAAA,CAAK,MAAM,UAAU,CAAA;AAAA,UAC7B;AAEA,UAAA,IAAI;AAEF,YAAA,MAAM,IAAA,GAAO,IAAA,CAAK,0BAAA,CAA2B,WAAW,CAAA;AACxD,YAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAoB,IAAI,CAAA;AACzD,YAAA,MAAM,UAAU,QAAA,CAAS,IAAA;AAGzB,YAAA,IAAI,IAAA,CAAK,iBAAA,CAAkB,OAAO,CAAA,EAAG;AACnC,cAAA,OAAO,OAAA;AAAA,YACT;AAGA,YAAA,IAAI,IAAA,CAAK,eAAA,CAAgB,OAAO,CAAA,EAAG;AACjC,cAAA,MAAM,IAAI,sBAAA;AAAA,gBACR,CAAA,2BAAA,EAA8B,QAAQ,MAAM,CAAA,CAAA;AAAA,gBAC5C;AAAA,eACF;AAAA,YACF;AAAA,UAIF,SAAS,KAAA,EAAO;AAEd,YAAA,IAAI,OAAA,KAAY,cAAc,CAAA,EAAG;AAC/B,cAAA,MAAM,IAAI,sBAAA;AAAA,gBACR,mCAAA;AAAA,gBACA,EAAE,KAAA,EAAO,WAAA,EAAa,OAAA;AAAQ,eAChC;AAAA,YACF;AAAA,UAGF;AAAA,QACF;AAEA,QAAA,MAAM,IAAI,sBAAA;AAAA,UACR,oCAAoC,WAAW,CAAA,iBAAA,CAAA;AAAA,UAC/C,EAAE,WAAA,EAAa,WAAA,EAAa,UAAA;AAAW,SACzC;AAAA,MACF;AAAA,MAEQ,2BAA2B,GAAA,EAAqB;AACtD,QAAA,IAAI;AACF,UAAA,MAAM,MAAA,GAAS,IAAI,GAAA,CAAI,GAAG,CAAA;AAC1B,UAAA,OAAO,MAAA,CAAO,WAAW,MAAA,CAAO,MAAA;AAAA,QAClC,CAAA,CAAA,MAAQ;AAEN,UAAA,OAAO,IAAI,UAAA,CAAW,GAAG,CAAA,GAAI,GAAA,GAAM,IAAI,GAAG,CAAA,CAAA;AAAA,QAC5C;AAAA,MACF;AAAA,MAEQ,kBAAkB,OAAA,EAAkC;AAC1D,QAAA,OAAO,CAAC,QAAA,EAAU,WAAW,CAAA,CAAE,QAAA,CAAS,QAAQ,MAAM,CAAA;AAAA,MACxD;AAAA,MAEQ,gBAAgB,OAAA,EAAkC;AACxD,QAAA,OAAO,CAAC,QAAA,EAAU,WAAA,EAAa,OAAO,CAAA,CAAE,QAAA,CAAS,QAAQ,MAAM,CAAA;AAAA,MACjE;AAAA,MAEQ,MAAM,EAAA,EAA2B;AACvC,QAAA,OAAO,IAAI,OAAA,CAAQ,CAAA,OAAA,KAAW,UAAA,CAAW,OAAA,EAAS,EAAE,CAAC,CAAA;AAAA,MACvD;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACrTA,IAiBa,iBAAA;AAjBb,IAAA,cAAA,GAAA,KAAA,CAAA;AAAA,EAAA,iCAAA,GAAA;AAiBO,IAAM,oBAAN,MAAwB;AAAA,MAC7B,YAA6B,IAAA,EAAkB;AAAlB,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,MAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAShD,MAAM,OAAO,IAAA,EAA0E;AACrF,QAAA,MAAM,IAAA,GAAO,YAAA;AACb,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA,CAAc,MAAM,IAAI,CAAA;AAEzD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,IAAA,CAAK,OAAA,GAA6B,EAAC,EAAmC;AAC1E,QAAA,MAAM,IAAA,GAAO,YAAA;AACb,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAA2B,MAAM,OAAO,CAAA;AAEzE,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,SAAS,SAAA,EAAqC;AAClD,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAa,IAAI,CAAA;AAElD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,MAAA,CAAO,SAAA,EAAmB,IAAA,EAA0C;AACxE,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAAa,MAAM,IAAI,CAAA;AAExD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,OAAO,SAAA,EAA8D;AACzE,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,OAAyC,IAAI,CAAA;AAE9E,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAUA,MAAM,iBAAA,CACJ,SAAA,EACA,eAAA,EAQkD;AAClD,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,YAAA,CAAA;AAGpC,QAAA,MAAM,QAAA,GAAW,KAAK,cAAA,EAAe;AAGrC,QAAA,IAAI,gBAAgB,QAAA,EAAU;AAC5B,UAAA,QAAA,CAAS,MAAA,CAAO,aAAA,EAAe,eAAA,CAAgB,IAAA,EAAM,gBAAgB,QAAQ,CAAA;AAAA,QAC/E,CAAA,MAAO;AACL,UAAA,QAAA,CAAS,MAAA,CAAO,aAAA,EAAe,eAAA,CAAgB,IAAI,CAAA;AAAA,QACrD;AAGA,QAAA,QAAA,CAAS,MAAA,CAAO,UAAA,EAAY,eAAA,CAAgB,QAAQ,CAAA;AAEpD,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA;AAAA,UAC/B,IAAA;AAAA,UACA;AAAA,SACF;AAEA,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,qBAAqB,SAAA,EAKxB;AACD,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,YAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAK9B,IAAI,CAAA;AAEP,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MASA,MAAM,gBAAgB,SAAA,EAA4C;AAChE,QAAA,MAAM,YAAY,MAAM,IAAA,CAAK,KAAK,EAAE,SAAA,EAAW,KAAK,CAAA;AAEpD,QAAA,OAAO,UAAU,IAAA,CAAK,IAAA;AAAA,UAAK,CAAA,OAAA,KACzB,QAAQ,gBAAA,KAAqB;AAAA,SAC/B,IAAK,IAAA;AAAA,MACP;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,4BAAA,GAAmD;AACvD,QAAA,MAAM,YAAY,MAAM,IAAA,CAAK,KAAK,EAAE,SAAA,EAAW,KAAK,CAAA;AAEpD,QAAA,MAAM,qBAAgC,EAAC;AAGvC,QAAA,KAAA,MAAW,OAAA,IAAW,UAAU,IAAA,EAAM;AACpC,UAAA,IAAI;AACF,YAAA,MAAM,UAAA,GAAa,MAAM,IAAA,CAAK,oBAAA,CAAqB,QAAQ,EAAG,CAAA;AAC9D,YAAA,IAAI,UAAA,CAAW,cAAA,IAAkB,UAAA,CAAW,OAAA,EAAS;AACnD,cAAA,kBAAA,CAAmB,KAAK,OAAO,CAAA;AAAA,YACjC;AAAA,UACF,CAAA,CAAA,MAAQ;AAEN,YAAA;AAAA,UACF;AAAA,QACF;AAEA,QAAA,OAAO,kBAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAKA,MAAM,WAAA,CACJ,SAAA,EACA,OAAA,GAGI,EAAC,EACmD;AACxD,QAAA,MAAM,EAAE,aAAA,GAAgB,CAAA,EAAG,eAAA,GAAkB,MAAK,GAAI,OAAA;AAEtD,QAAA,MAAM,UAAyD,EAAC;AAGhE,QAAA,KAAA,IAAS,IAAI,CAAA,EAAG,CAAA,GAAI,SAAA,CAAU,MAAA,EAAQ,KAAK,aAAA,EAAe;AACxD,UAAA,MAAM,KAAA,GAAQ,SAAA,CAAU,KAAA,CAAM,CAAA,EAAG,IAAI,aAAa,CAAA;AAElD,UAAA,MAAM,aAAA,GAAgB,KAAA,CAAM,GAAA,CAAI,OAAO,WAAA,KAAgB;AACrD,YAAA,IAAI;AACF,cAAA,OAAO,MAAM,IAAA,CAAK,MAAA,CAAO,WAAW,CAAA;AAAA,YACtC,SAAS,KAAA,EAAO;AACd,cAAA,IAAI,eAAA,EAAiB;AACnB,gBAAA,OAAO;AAAA,kBACL,KAAA,EAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,eAAA;AAAA,kBAChD,IAAA,EAAM;AAAA,iBACR;AAAA,cACF,CAAA,MAAO;AACL,gBAAA,MAAM,KAAA;AAAA,cACR;AAAA,YACF;AAAA,UACF,CAAC,CAAA;AAED,UAAA,MAAM,YAAA,GAAe,MAAM,OAAA,CAAQ,GAAA,CAAI,aAAa,CAAA;AACpD,UAAA,OAAA,CAAQ,IAAA,CAAK,GAAG,YAAY,CAAA;AAAA,QAC9B;AAEA,QAAA,OAAO,OAAA;AAAA,MACT;AAAA;AAAA;AAAA;AAAA,MAMQ,cAAA,GAAsB;AAC5B,QAAA,IAAI,OAAO,aAAa,WAAA,EAAa;AACnC,UAAA,OAAO,IAAI,QAAA,EAAS;AAAA,QACtB,CAAA,MAAO;AAEL,UAAA,MAAM,IAAI,MAAM,+CAA+C,CAAA;AAAA,QACjE;AAAA,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACnOA,IAYa,mBAAA;AAZb,IAAA,iBAAA,GAAA,KAAA,CAAA;AAAA,EAAA,oCAAA,GAAA;AAYO,IAAM,sBAAN,MAA0B;AAAA,MAC/B,YAA6B,IAAA,EAAkB;AAAlB,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,MAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAchD,MAAM,KAAK,SAAA,EAA2D;AACpE,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,YAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAA+B,IAAI,CAAA;AAEpE,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAyBA,MAAM,MAAA,CACJ,SAAA,EACA,IAAA,EACsB;AACtB,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,YAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA,CAAkB,MAAM,IAAI,CAAA;AAE7D,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkBA,MAAM,QAAA,CACJ,SAAA,EACA,aAAA,EACsB;AACtB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,aAAA,EAAgB,aAAa,CAAA,CAAA;AACjE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAiB,IAAI,CAAA;AAEtD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAmBA,MAAM,MAAA,CACJ,SAAA,EACA,aAAA,EACA,IAAA,EACsB;AACtB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,aAAA,EAAgB,aAAa,CAAA,CAAA;AACjE,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAAiB,MAAM,IAAI,CAAA;AAE5D,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAaA,MAAM,MAAA,CACJ,SAAA,EACA,aAAA,EACe;AACf,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,aAAA,EAAgB,aAAa,CAAA,CAAA;AACjE,QAAA,MAAM,IAAA,CAAK,IAAA,CAAK,MAAA,CAAO,IAAI,CAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBA,MAAM,WAAA,CACJ,SAAA,EACA,IAAA,EACwB;AACxB,QAAA,MAAM,QAAA,GAAW,KAAK,GAAA,CAAI,CAAA,MAAA,KAAU,KAAK,MAAA,CAAO,SAAA,EAAW,MAAM,CAAC,CAAA;AAClE,QAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAoBA,MAAM,eAAA,CACJ,SAAA,EACA,gBAAA,EACkC;AAClC,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,CAAK,SAAS,CAAA;AACxC,QAAA,OAAO,OAAO,IAAA,EAAM,IAAA;AAAA,UAClB,CAAC,MAAA,KACC,MAAA,CAAO,gBAAA,EAAkB,UAAS,KAAM;AAAA,SAC5C;AAAA,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC/LA,IAYa,qBAAA;AAZb,IAAA,mBAAA,GAAA,KAAA,CAAA;AAAA,EAAA,sCAAA,GAAA;AAYO,IAAM,wBAAN,MAA4B;AAAA,MACjC,YAA6B,IAAA,EAAkB;AAAlB,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,MAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAchD,MAAM,KAAK,SAAA,EAA6D;AACtE,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,cAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAiC,IAAI,CAAA;AAEtE,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAyBA,MAAM,MAAA,CACJ,SAAA,EACA,IAAA,EACwB;AACxB,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,cAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA,CAAoB,MAAM,IAAI,CAAA;AAE/D,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkBA,MAAM,QAAA,CACJ,SAAA,EACA,eAAA,EACwB;AACxB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,eAAA,EAAkB,eAAe,CAAA,CAAA;AACrE,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAmB,IAAI,CAAA;AAExD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAmBA,MAAM,MAAA,CACJ,SAAA,EACA,eAAA,EACA,IAAA,EACwB;AACxB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,eAAA,EAAkB,eAAe,CAAA,CAAA;AACrE,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAAmB,MAAM,IAAI,CAAA;AAE9D,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAaA,MAAM,MAAA,CACJ,SAAA,EACA,eAAA,EACe;AACf,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,eAAA,EAAkB,eAAe,CAAA,CAAA;AACrE,QAAA,MAAM,IAAA,CAAK,IAAA,CAAK,MAAA,CAAO,IAAI,CAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBA,MAAM,WAAA,CACJ,SAAA,EACA,IAAA,EAC0B;AAC1B,QAAA,MAAM,QAAA,GAAW,KAAK,GAAA,CAAI,CAAA,MAAA,KAAU,KAAK,MAAA,CAAO,SAAA,EAAW,MAAM,CAAC,CAAA;AAClE,QAAA,OAAO,OAAA,CAAQ,IAAI,QAAQ,CAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAoBA,MAAM,eAAA,CACJ,SAAA,EACA,gBAAA,EACoC;AACpC,QAAA,MAAM,MAAA,GAAS,MAAM,IAAA,CAAK,IAAA,CAAK,SAAS,CAAA;AACxC,QAAA,OAAO,OAAO,IAAA,EAAM,IAAA;AAAA,UAClB,CAAC,MAAA,KACC,MAAA,CAAO,gBAAA,EAAkB,UAAS,KAAM;AAAA,SAC5C;AAAA,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;AC/LA,IAYa,gBAAA;AAZb,IAAA,aAAA,GAAA,KAAA,CAAA;AAAA,EAAA,gCAAA,GAAA;AAYO,IAAM,mBAAN,MAAuB;AAAA,MAC5B,YAA6B,IAAA,EAAkB;AAAlB,QAAA,IAAA,CAAA,IAAA,GAAA,IAAA;AAAA,MAAmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAchD,MAAM,KAAK,SAAA,EAAuD;AAChE,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,SAAA,CAAA;AACpC,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAA2B,IAAI,CAAA;AAEhE,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkBA,MAAM,MAAA,CACJ,SAAA,EACA,IAAA,EACkB;AAClB,QAAA,MAAM,IAAA,GAAO,cAAc,SAAS,CAAA,SAAA,CAAA;AACpC,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA,CAAc,MAAM,IAAI,CAAA;AAEzD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAeA,MAAM,QAAA,CACJ,SAAA,EACA,SAAA,EACkB;AAClB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,UAAA,EAAa,SAAS,CAAA,CAAA;AAC1D,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAa,IAAI,CAAA;AAElD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAmBA,MAAM,MAAA,CACJ,SAAA,EACA,SAAA,EACA,IAAA,EACkB;AAClB,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,UAAA,EAAa,SAAS,CAAA,CAAA;AAC1D,QAAA,MAAM,WAAW,MAAM,IAAA,CAAK,IAAA,CAAK,GAAA,CAAa,MAAM,IAAI,CAAA;AAExD,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAcA,MAAM,MAAA,CACJ,SAAA,EACA,SAAA,EACe;AACf,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,UAAA,EAAa,SAAS,CAAA,CAAA;AAC1D,QAAA,MAAM,IAAA,CAAK,IAAA,CAAK,MAAA,CAAO,IAAI,CAAA;AAAA,MAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkCA,iBAAA,CACE,OAAA,EACA,SAAA,EACA,MAAA,EACS;AACT,QAAA,IAAI;AAEF,UAAA,MAAM,MAAA,GAAU,UAAA,CAAmB,OAAA,GAAU,QAAQ,CAAA;AACrD,UAAA,IAAI,CAAC,MAAA,EAAQ;AACX,YAAA,MAAM,IAAI,MAAM,6BAA6B,CAAA;AAAA,UAC/C;AAEA,UAAA,MAAM,IAAA,GAAO,MAAA,CAAO,UAAA,CAAW,QAAA,EAAU,MAAM,CAAA;AAC/C,UAAA,IAAA,CAAK,OAAO,OAAO,CAAA;AACnB,UAAA,MAAM,iBAAA,GAAoB,IAAA,CAAK,MAAA,CAAO,KAAK,CAAA;AAG3C,UAAA,OAAO,MAAA,CAAO,eAAA;AAAA,YACZ,MAAA,CAAO,KAAK,SAAS,CAAA;AAAA,YACrB,MAAA,CAAO,KAAK,iBAAiB;AAAA,WAC/B;AAAA,QACF,SAAS,KAAA,EAAO;AACd,UAAA,OAAA,CAAQ,KAAA,CAAM,uCAAuC,KAAK,CAAA;AAC1D,UAAA,OAAO,KAAA;AAAA,QACT;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAmBA,MAAM,IAAA,CACJ,SAAA,EACA,SAAA,EACiD;AACjD,QAAA,MAAM,IAAA,GAAO,CAAA,WAAA,EAAc,SAAS,CAAA,UAAA,EAAa,SAAS,CAAA,KAAA,CAAA;AAC1D,QAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAA;AAAA,UAC/B,IAAA;AAAA,UACA;AAAC,SACH;AAEA,QAAA,OAAO,QAAA,CAAS,IAAA;AAAA,MAClB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAeA,kBAAA,GAAqC;AACnC,QAAA,OAAO;AAAA,UACL,gBAAA;AAAA,UACA,mBAAA;AAAA,UACA,gBAAA;AAAA,UACA,oBAAA;AAAA,UACA,iBAAA;AAAA,UACA,iBAAA;AAAA,UACA;AAAA,SACF;AAAA,MACF;AAAA,KACF;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACpPA,IAAA,cAAA,GAAA,KAAA,CAAA;AAAA,EAAA,6BAAA,GAAA;AAOA,IAAA,qBAAA,EAAA;AACA,IAAA,cAAA,EAAA;AACA,IAAA,iBAAA,EAAA;AACA,IAAA,mBAAA,EAAA;AACA,IAAA,aAAA,EAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACXA,IAAA,cAAA,GAAA,EAAA;AAAA,QAAA,CAAA,cAAA,EAAA;AAAA,EAAA,sBAAA,EAAA,MAAA,sBAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,SAAA,EAAA,MAAA,SAAA;AAAA,EAAA,uBAAA,EAAA,MAAA,uBAAA;AAAA,EAAA,OAAA,EAAA,MAAA,OAAA;AAAA,EAAA,eAAA,EAAA,MAAA,eAAA;AAAA,EAAA,OAAA,EAAA,MAAA;AAAA,CAAA,CAAA;AA6tBO,SAAS,gBAAgB,MAAA,EAAuC;AACrE,EAAA,MAAM,SAAS,OAAO,MAAA,KAAW,QAAA,GAAW,EAAE,QAAO,GAAI,MAAA;AACzD,EAAA,OAAO,IAAI,UAAU,MAAM,CAAA;AAC7B;AAwBe,SAAR,IAAqB,MAAA,EAAuC;AACjE,EAAA,OAAO,gBAAgB,MAAM,CAAA;AAC/B;AA1vBA,IA0Ga,SAAA,CAAA,CA0pBA,OAAA,CAAA,CAMA,uBAAA,CAAA,CAMA,eAAA,CAAA,CAMA;AAtxBb,IAAAA,YAAAA,GAAA,KAAA,CAAA;AAAA,EAAA,oBAAA,GAAA;AAkBA,IAAA,WAAA,EAAA;AACA,IAAA,WAAA,EAAA;AAGA,IAAA,cAAA,EAAA;AAoFO,IAAM,YAAN,MAAgB;AAAA;AAAA,MAEJ,IAAA;AAAA;AAAA,MAGA,MAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAuBD,eAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAsBA,SAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAqBA,WAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAqBA,aAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAsBA,QAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAuChB,YAAY,MAAA,EAAmB;AAE7B,QAAA,IAAA,CAAK,MAAA,GAAS,IAAA,CAAK,0BAAA,CAA2B,MAAM,CAAA;AAGpD,QAAA,IAAA,CAAK,mBAAA,EAAoB;AAGzB,QAAA,MAAM,UAAA,GAAa,eAAA;AAAA,UACjB,KAAK,MAAA,CAAO,MAAA;AAAA,UACZ,KAAK,UAAA,EAAW;AAAA,UAChB,KAAK,MAAA,CAAO,OAAA;AAAA,UACZ,KAAK,MAAA,CAAO;AAAA,SACd;AACA,QAAA,IAAA,CAAK,IAAA,GAAO,IAAI,UAAA,CAAW,UAAU,CAAA;AAGrC,QAAA,IAAA,CAAK,eAAA,GAAkB,IAAI,uBAAA,CAAwB,IAAA,CAAK,IAAI,CAAA;AAC5D,QAAA,IAAA,CAAK,SAAA,GAAY,IAAI,iBAAA,CAAkB,IAAA,CAAK,IAAI,CAAA;AAChD,QAAA,IAAA,CAAK,WAAA,GAAc,IAAI,mBAAA,CAAoB,IAAA,CAAK,IAAI,CAAA;AACpD,QAAA,IAAA,CAAK,aAAA,GAAgB,IAAI,qBAAA,CAAsB,IAAA,CAAK,IAAI,CAAA;AACxD,QAAA,IAAA,CAAK,QAAA,GAAW,IAAI,gBAAA,CAAiB,IAAA,CAAK,IAAI,CAAA;AAAA,MAChD;AAAA;AAAA;AAAA;AAAA,MAMQ,2BAA2B,MAAA,EAAsC;AACvE,QAAA,IAAI,CAAC,OAAO,MAAA,EAAQ;AAElB,UAAA,MAAM,SAAA,GAAY,IAAA,CAAK,sBAAA,CAAuB,aAAa,CAAA;AAC3D,UAAA,IAAI,CAAC,SAAA,EAAW;AACd,YAAA,MAAM,aAAa,iBAAA,EAAkB;AAAA,UACvC;AACA,UAAA,MAAA,CAAO,MAAA,GAAS,SAAA;AAAA,QAClB;AAGA,QAAA,MAAM,WAAA,GAAc,OAAO,WAAA,IAAe,YAAA;AAC1C,QAAA,IAAI,CAAC,CAAC,YAAA,EAAc,SAAS,CAAA,CAAE,QAAA,CAAS,WAAW,CAAA,EAAG;AACpD,UAAA,MAAM,IAAI,kBAAA;AAAA,YACR,wBAAwB,WAAW,CAAA,oCAAA,CAAA;AAAA,YACnC,EAAE,WAAA;AAAY,WAChB;AAAA,QACF;AAGA,QAAA,MAAM,gBAAA,GAAsC;AAAA,UAC1C,QAAQ,MAAA,CAAO,MAAA;AAAA,UACf,WAAA;AAAA,UACA,OAAA,EAAS,MAAA,CAAO,OAAA,IAAW,IAAA,CAAK,kBAAkB,WAAW,CAAA;AAAA,UAC7D,OAAA,EAAS,OAAO,OAAA,IAAW,GAAA;AAAA,UAC3B,WAAA,EAAa,MAAA,CAAO,WAAA,IAAe,wBAAA;AAAyB,SAC9D;AAEA,QAAA,OAAO,gBAAA;AAAA,MACT;AAAA,MAEQ,kBAAkB,WAAA,EAA+C;AACvE,QAAA,MAAM,QAAA,GAAW;AAAA,UACf,UAAA,EAAY,uBAAA;AAAA,UACZ,OAAA,EAAS;AAAA;AAAA,SACX;AACA,QAAA,OAAO,SAAS,WAAW,CAAA;AAAA,MAC7B;AAAA,MAEQ,UAAA,GAAqB;AAC3B,QAAA,OAAO,KAAK,MAAA,CAAO,OAAA;AAAA,MACrB;AAAA,MAEQ,uBAAuB,IAAA,EAAkC;AAE/D,QAAA,IAAI;AACF,UAAA,OAAQ,UAAA,CAAmB,OAAA,EAAS,GAAA,GAAM,IAAI,CAAA;AAAA,QAChD,CAAA,CAAA,MAAQ;AACN,UAAA,OAAO,MAAA;AAAA,QACT;AAAA,MACF;AAAA;AAAA;AAAA;AAAA,MAMQ,mBAAA,GAA4B;AAElC,QAAA,IAAA,CAAK,mBAAA,EAAoB;AAGzB,QAAA,IAAI,OAAO,UAAU,WAAA,EAAa;AAChC,UAAA,MAAM,YAAA,CAAa,oBAAA,CAAqB,IAAA,CAAK,cAAA,EAAgB,CAAA;AAAA,QAC/D;AAAA,MACF;AAAA,MAEQ,mBAAA,GAA4B;AAClC,QAAA,MAAM,WAAA,GAAc,KAAK,cAAA,EAAe;AACxC,QAAA,MAAM,YAAA,GAAe,IAAA,CAAK,mBAAA,CAAoB,WAAW,CAAA;AAEzD,QAAA,IAAI,eAAe,EAAA,EAAI;AACrB,UAAA,MAAM,YAAA,CAAa,qBAAqB,WAAW,CAAA;AAAA,QACrD;AAAA,MACF;AAAA,MAEQ,cAAA,GAAyB;AAC/B,QAAA,IAAI;AACF,UAAA,OAAQ,UAAA,CAAmB,SAAS,OAAA,IAAW,SAAA;AAAA,QACjD,CAAA,CAAA,MAAQ;AACN,UAAA,OAAO,SAAA;AAAA,QACT;AAAA,MACF;AAAA,MAEQ,oBAAoB,OAAA,EAAyB;AACnD,QAAA,MAAM,KAAA,GAAQ,OAAA,CAAQ,KAAA,CAAM,YAAY,CAAA;AACxC,QAAA,OAAO,QAAQ,QAAA,CAAS,KAAA,CAAM,CAAC,CAAA,EAAI,EAAE,CAAA,GAAI,CAAA;AAAA,MAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAuBO,aAAa,SAAA,EAAqC;AACvD,QAAA,MAAM,eAAe,EAAE,GAAG,IAAA,CAAK,MAAA,EAAQ,GAAG,SAAA,EAAU;AACpD,QAAA,MAAM,gBAAA,GAAmB,IAAA,CAAK,0BAAA,CAA2B,YAAY,CAAA;AAGrE,QAAA,MAAA,CAAO,MAAA,CAAO,IAAA,CAAK,MAAA,EAAQ,gBAAgB,CAAA;AAG3C,QAAA,MAAM,UAAA,GAAa,eAAA;AAAA,UACjB,KAAK,MAAA,CAAO,MAAA;AAAA,UACZ,KAAK,UAAA,EAAW;AAAA,UAChB,KAAK,MAAA,CAAO,OAAA;AAAA,UACZ,KAAK,MAAA,CAAO;AAAA,SACd;AACA,QAAA,MAAA,CAAO,OAAO,IAAA,CAAK,IAAA,EAAM,IAAI,UAAA,CAAW,UAAU,CAAC,CAAA;AAAA,MACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAeO,WAAW,OAAA,EAAuB;AACvC,QAAA,IAAA,CAAK,YAAA,CAAa,EAAE,OAAA,EAAS,CAAA;AAAA,MAC/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAeO,UAAU,MAAA,EAAsB;AACrC,QAAA,IAAA,CAAK,YAAA,CAAa,EAAE,MAAA,EAAQ,CAAA;AAAA,MAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAeO,SAAA,GAAyC;AAC9C,QAAA,OAAO,EAAE,GAAG,IAAA,CAAK,MAAA,EAAO;AAAA,MAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkDA,MAAa,iBAAA,CACX,WAAA,EACA,OAAA,GAAuB,EAAC,EACZ;AACZ,QAAA,MAAM;AAAA,UACJ,WAAA,GAAc,EAAA;AAAA,UACd,UAAA,GAAa;AAAA,SACf,GAAI,OAAA;AAEJ,QAAA,KAAA,IAAS,OAAA,GAAU,CAAA,EAAG,OAAA,GAAU,WAAA,EAAa,OAAA,EAAA,EAAW;AAEtD,UAAA,IAAI,UAAU,CAAA,EAAG;AACf,YAAA,MAAM,IAAA,CAAK,MAAM,UAAU,CAAA;AAAA,UAC7B;AAEA,UAAA,IAAI;AAEF,YAAA,MAAM,IAAA,GAAO,IAAA,CAAK,kBAAA,CAAmB,WAAW,CAAA;AAChD,YAAA,MAAM,QAAA,GAAW,MAAM,IAAA,CAAK,IAAA,CAAK,IAAS,IAAI,CAAA;AAG9C,YAAA,IAAI,IAAA,CAAK,kBAAA,CAAmB,QAAA,CAAS,IAAI,CAAA,EAAG;AAC1C,cAAA,OAAO,QAAA,CAAS,IAAA;AAAA,YAClB;AAEA,YAAA,IAAI,IAAA,CAAK,gBAAA,CAAiB,QAAA,CAAS,IAAI,CAAA,EAAG;AACxC,cAAA,MAAM,IAAI,mBAAA;AAAA,gBACR,CAAA,4BAAA,EAA+B,QAAA,CAAS,IAAA,CAAK,KAAA,IAAS,eAAe,CAAA,CAAA;AAAA,gBACrE,QAAA,CAAS;AAAA,eACX;AAAA,YACF;AAAA,UAIF,SAAS,KAAA,EAAO;AAEd,YAAA,IAAI,OAAA,KAAY,cAAc,CAAA,EAAG;AAC/B,cAAA,MAAM,KAAA;AAAA,YACR;AAAA,UAGF;AAAA,QACF;AAEA,QAAA,MAAM,IAAI,mBAAA;AAAA,UACR,yBAAyB,WAAW,CAAA,4CAAA,CAAA;AAAA,UACpC,EAAE,aAAa,UAAA;AAAW,SAC5B;AAAA,MACF;AAAA,MAEQ,mBAAmB,GAAA,EAAqB;AAC9C,QAAA,IAAI;AACF,UAAA,MAAM,MAAA,GAAS,IAAI,GAAA,CAAI,GAAG,CAAA;AAC1B,UAAA,OAAO,MAAA,CAAO,WAAW,MAAA,CAAO,MAAA;AAAA,QAClC,CAAA,CAAA,MAAQ;AAEN,UAAA,OAAO,IAAI,UAAA,CAAW,GAAG,CAAA,GAAI,GAAA,GAAM,IAAI,GAAG,CAAA,CAAA;AAAA,QAC5C;AAAA,MACF;AAAA,MAEQ,mBAAmB,IAAA,EAAoB;AAC7C,QAAA,OAAO,IAAA,KACL,IAAA,CAAK,MAAA,KAAW,WAAA,IAChB,IAAA,CAAK,MAAA,KAAW,QAAA,IACf,IAAA,CAAK,EAAA,IAAM,IAAA,CAAK,MAAA,IAAU,CAAC,IAAA,CAAK,MAAA,CAAA;AAAA,MAErC;AAAA,MAEQ,iBAAiB,IAAA,EAAoB;AAC3C,QAAA,OAAO,SACL,IAAA,CAAK,MAAA,KAAW,YAChB,IAAA,CAAK,MAAA,KAAW,WAChB,IAAA,CAAK,KAAA,CAAA;AAAA,MAET;AAAA,MAEQ,MAAM,EAAA,EAA2B;AACvC,QAAA,OAAO,IAAI,OAAA,CAAQ,CAAA,OAAA,KAAW,UAAA,CAAW,OAAA,EAAS,EAAE,CAAC,CAAA;AAAA,MACvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAwCA,MAAa,WAAA,GAAkE;AAC7E,QAAA,IAAI;AAEF,UAAA,MAAM,KAAK,IAAA,CAAK,GAAA,CAAI,cAAc,EAAE,SAAA,EAAW,GAAG,CAAA;AAClD,UAAA,OAAO,EAAE,QAAQ,IAAA,EAAK;AAAA,QACxB,SAAS,KAAA,EAAO;AACd,UAAA,OAAO;AAAA,YACL,MAAA,EAAQ,OAAA;AAAA,YACR,OAAA,EAAS;AAAA,cACP,KAAA,EAAO,KAAA,YAAiB,KAAA,GAAQ,KAAA,CAAM,OAAA,GAAU,eAAA;AAAA,cAChD,MAAA,EAAQ;AAAA,gBACN,OAAA,EAAS,KAAK,MAAA,CAAO,OAAA;AAAA,gBACrB,WAAA,EAAa,KAAK,MAAA,CAAO,WAAA;AAAA,gBACzB,SAAA,EAAW,CAAC,CAAC,IAAA,CAAK,MAAA,CAAO;AAAA;AAC3B;AACF,WACF;AAAA,QACF;AAAA,MACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiCO,aAAA,GAML;AACA,QAAA,OAAO;AAAA,UACL,OAAA,EAAS,cAAA;AAAA;AAAA,UACT,WAAA,EAAa,KAAK,cAAA,EAAe;AAAA,UACjC,WAAA,EAAa,KAAK,MAAA,CAAO,WAAA;AAAA,UACzB,OAAA,EAAS,KAAK,MAAA,CAAO,OAAA;AAAA,UACrB,SAAA,EAAW,CAAC,CAAC,IAAA,CAAK,MAAA,CAAO;AAAA,SAC3B;AAAA,MACF;AAAA,KACF;AA4EO,IAAM,OAAA,GAAU,cAAA;AAMhB,IAAM,uBAAA,GAA0B,UAAA;AAMhC,IAAM,eAAA,GAAkB,GAAA;AAMxB,IAAM,sBAAA,GAAyB,CAAA;AAAA,EAAA;AAAA,CAAA,CAAA;;;ACruBtCA,YAAAA,EAAAA;AA8DA,WAAA,EAAA;AA6EAA,YAAAA,EAAAA;AACA,IAAO,aAAA,GAAQ;AAUR,IAAM,YAAA,GAAe;AAMrB,IAAM,eAAA,GAAkB;AAMxB,IAAM,WAAA,GAAc;AAMpB,IAAM,cAAA,GAAiB;AAMvB,IAAM,iBAAA,GAAoB;AA0B1B,SAAS,sBAAA,GAWd;AACA,EAAA,MAAM,SAAmB,EAAC;AAC1B,EAAA,IAAI,WAAA;AAGJ,EAAA,IAAI;AACF,IAAA,WAAA,GAAe,WAAmB,OAAA,EAAS,OAAA;AAC3C,IAAA,IAAI,WAAA,EAAa;AACf,MAAA,MAAM,YAAA,GAAe,QAAA,CAAS,WAAA,CAAY,KAAA,CAAM,CAAC,EAAE,KAAA,CAAM,GAAG,CAAA,CAAE,CAAC,CAAE,CAAA;AACjE,MAAA,IAAI,eAAe,EAAA,EAAI;AACrB,QAAA,MAAA,CAAO,IAAA,CAAK,CAAA,QAAA,EAAW,YAAY,CAAA,wCAAA,CAA0C,CAAA;AAAA,MAC/E;AAAA,IACF;AAAA,EACF,CAAA,CAAA,MAAQ;AACN,IAAA,MAAA,CAAO,KAAK,kCAAkC,CAAA;AAAA,EAChD;AAGA,EAAA,MAAM,QAAA,GAAW,OAAO,KAAA,KAAU,WAAA;AAClC,EAAA,IAAI,CAAC,QAAA,EAAU;AACb,IAAA,MAAA,CAAO,KAAK,yBAAyB,CAAA;AAAA,EACvC;AAGA,EAAA,MAAM,kBAAA,GAAqB,OAAO,eAAA,KAAoB,WAAA;AACtD,EAAA,IAAI,CAAC,kBAAA,EAAoB;AACvB,IAAA,MAAA,CAAO,KAAK,+BAA+B,CAAA;AAAA,EAC7C;AAEA,EAAA,MAAM,MAAA,GAMF;AAAA,IACF,SAAA,EAAW,OAAO,MAAA,KAAW,CAAA;AAAA,IAC7B,QAAA;AAAA,IACA,kBAAA;AAAA,IACA;AAAA,GACF;AAEA,EAAA,IAAI,WAAA,EAAa;AACf,IAAA,MAAA,CAAO,WAAA,GAAc,WAAA;AAAA,EACvB;AAEA,EAAA,OAAO,MAAA;AACT;AAoBO,SAAS,cAAA,GAWd;AACA,EAAA,IAAI,WAAA,GAAc,SAAA;AAClB,EAAA,IAAI,QAAA,GAAW,SAAA;AACf,EAAA,IAAI,IAAA,GAAO,SAAA;AACX,EAAA,IAAI,WAAA,GAA8C,SAAA;AAElD,EAAA,IAAI;AACF,IAAA,MAAMC,WAAW,UAAA,CAAmB,OAAA;AACpC,IAAA,IAAIA,QAAAA,EAAS;AACX,MAAA,WAAA,GAAcA,SAAQ,OAAA,IAAW,SAAA;AACjC,MAAA,QAAA,GAAWA,SAAQ,QAAA,IAAY,SAAA;AAC/B,MAAA,IAAA,GAAOA,SAAQ,IAAA,IAAQ,SAAA;AACvB,MAAA,WAAA,GAAc,MAAA;AAAA,IAChB,WAAW,OAAO,MAAA,KAAW,eAAe,OAAQ,MAAA,CAAe,cAAc,WAAA,EAAa;AAC5F,MAAA,WAAA,GAAc,SAAA;AACd,MAAA,QAAA,GAAY,MAAA,CAAe,UAAU,QAAA,IAAY,SAAA;AAAA,IACnD;AAAA,EACF,CAAA,CAAA,MAAQ;AAAA,EAER;AAEA,EAAA,OAAO;AAAA,IACL,UAAA,EAAY,eAAA;AAAA,IACZ,WAAA;AAAA,IACA,QAAA;AAAA,IACA,IAAA;AAAA,IACA;AAAA,GACF;AACF;AAoCO,SAAS,oBAAoB,WAAA,EAAwC;AAC1E,EAAA,MAAM,MAAA,GAAU,UAAA,CAAmB,OAAA,EAAS,GAAA,EAAK,WAAA;AACjD,EAAA,IAAI,CAAC,MAAA,EAAQ;AACX,IAAA,MAAM,EAAE,kBAAA,EAAAC,mBAAAA,EAAmB,IAAI,WAAA,EAAA,EAAA,YAAA,CAAA,cAAA,CAAA,CAAA;AAC/B,IAAA,MAAM,IAAIA,mBAAAA;AAAA,MACR;AAAA,KACF;AAAA,EACF;AAEA,EAAA,MAAM,EAAE,SAAA,EAAAC,UAAAA,EAAU,IAAI,YAAA,EAAA,EAAA,YAAA,CAAA,cAAA,CAAA,CAAA;AACtB,EAAA,OAAO,IAAIA,UAAAA,CAAU;AAAA,IACnB,MAAA;AAAA,IACA,aAAa,WAAA,IAAe;AAAA,GAC7B,CAAA;AACH;AAiCO,SAAS,qBAAqB,MAAA,EAKnC;AACA,EAAA,MAAM,SAAmB,EAAC;AAE1B,EAAA,IAAI,CAAC,MAAA,EAAQ;AACX,IAAA,MAAA,CAAO,KAAK,qBAAqB,CAAA;AAAA,EACnC,CAAA,MAAO;AACL,IAAA,IAAI,MAAA,CAAO,SAAS,EAAA,EAAI;AACtB,MAAA,MAAA,CAAO,KAAK,iCAAiC,CAAA;AAAA,IAC/C;AAEA,IAAA,IAAI,MAAA,CAAO,QAAA,CAAS,GAAG,CAAA,EAAG;AACxB,MAAA,MAAA,CAAO,KAAK,mCAAmC,CAAA;AAAA,IACjD;AAAA,EAGF;AAEA,EAAA,OAAO;AAAA,IACL,KAAA,EAAO,OAAO,MAAA,KAAW,CAAA;AAAA,IACzB;AAAA,GACF;AACF","file":"index.js","sourcesContent":["/**\r\n * NFE.io SDK v3 - Error Classes\r\n * \r\n * Comprehensive error handling system that maintains compatibility\r\n * with v2 error types while providing modern TypeScript benefits\r\n */\r\n\r\n// ============================================================================\r\n// Base Error Class\r\n// ============================================================================\r\n\r\nexport class NfeError extends Error {\r\n  public readonly type: string = 'NfeError';\r\n  public readonly code?: number | undefined;\r\n  public readonly details?: unknown;\r\n  public readonly raw?: unknown;\r\n\r\n  constructor(message: string, details?: unknown, code?: number) {\r\n    super(message);\r\n    this.name = this.constructor.name;\r\n    this.code = code;\r\n    this.details = details;\r\n    this.raw = details;\r\n\r\n    // Ensure proper prototype chain for instanceof checks\r\n    Object.setPrototypeOf(this, new.target.prototype);\r\n\r\n    // Capture stack trace if available (Node.js specific)\r\n    if ('captureStackTrace' in Error && typeof (Error as any).captureStackTrace === 'function') {\r\n      (Error as any).captureStackTrace(this, this.constructor);\r\n    }\r\n  }\r\n\r\n  /** Convert error to JSON for logging/debugging */\r\n  toJSON() {\r\n    return {\r\n      type: this.type,\r\n      name: this.name,\r\n      message: this.message,\r\n      code: this.code,\r\n      details: this.details,\r\n      stack: this.stack,\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HTTP-specific Errors (maintain v2 compatibility)\r\n// ============================================================================\r\n\r\nexport class AuthenticationError extends NfeError {\r\n  public override readonly type = 'AuthenticationError';\r\n\r\n  constructor(message = 'Invalid API key or authentication failed', details?: unknown) {\r\n    super(message, details, 401);\r\n  }\r\n}\r\n\r\nexport class ValidationError extends NfeError {\r\n  public override readonly type = 'ValidationError';\r\n\r\n  constructor(message = 'Invalid request data', details?: unknown) {\r\n    super(message, details, 400);\r\n  }\r\n}\r\n\r\nexport class NotFoundError extends NfeError {\r\n  public override readonly type = 'NotFoundError';\r\n\r\n  constructor(message = 'Resource not found', details?: unknown) {\r\n    super(message, details, 404);\r\n  }\r\n}\r\n\r\nexport class ConflictError extends NfeError {\r\n  public override readonly type = 'ConflictError';\r\n\r\n  constructor(message = 'Resource conflict', details?: unknown) {\r\n    super(message, details, 409);\r\n  }\r\n}\r\n\r\nexport class RateLimitError extends NfeError {\r\n  public override readonly type = 'RateLimitError';\r\n\r\n  constructor(message = 'Rate limit exceeded', details?: unknown) {\r\n    super(message, details, 429);\r\n  }\r\n}\r\n\r\nexport class ServerError extends NfeError {\r\n  public override readonly type = 'ServerError';\r\n\r\n  constructor(message = 'Internal server error', details?: unknown, code = 500) {\r\n    super(message, details, code);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Connection/Network Errors\r\n// ============================================================================\r\n\r\nexport class ConnectionError extends NfeError {\r\n  public override readonly type = 'ConnectionError';\r\n\r\n  constructor(message = 'Connection error', details?: unknown) {\r\n    super(message, details);\r\n  }\r\n}\r\n\r\nexport class TimeoutError extends NfeError {\r\n  public override readonly type = 'TimeoutError';\r\n\r\n  constructor(message = 'Request timeout', details?: unknown) {\r\n    super(message, details);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// SDK-specific Errors\r\n// ============================================================================\r\n\r\nexport class ConfigurationError extends NfeError {\r\n  public override readonly type = 'ConfigurationError';\r\n\r\n  constructor(message = 'SDK configuration error', details?: unknown) {\r\n    super(message, details);\r\n  }\r\n}\r\n\r\nexport class PollingTimeoutError extends NfeError {\r\n  public override readonly type = 'PollingTimeoutError';\r\n\r\n  constructor(message = 'Polling timeout - operation still in progress', details?: unknown) {\r\n    super(message, details);\r\n  }\r\n}\r\n\r\nexport class InvoiceProcessingError extends NfeError {\r\n  public override readonly type = 'InvoiceProcessingError';\r\n\r\n  constructor(message = 'Invoice processing failed', details?: unknown) {\r\n    super(message, details);\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Error Factory (maintains v2 compatibility)\r\n// ============================================================================\r\n\r\nexport class ErrorFactory {\r\n  /**\r\n   * Create error from HTTP response (maintains v2 ResourceError.generate pattern)\r\n   */\r\n  static fromHttpResponse(status: number, data?: unknown, message?: string): NfeError {\r\n    const errorMessage = message || this.getDefaultMessage(status);\r\n\r\n    switch (status) {\r\n      case 400:\r\n        return new ValidationError(errorMessage, data);\r\n      case 401:\r\n        return new AuthenticationError(errorMessage, data);\r\n      case 404:\r\n        return new NotFoundError(errorMessage, data);\r\n      case 409:\r\n        return new ConflictError(errorMessage, data);\r\n      case 429:\r\n        return new RateLimitError(errorMessage, data);\r\n      case 500:\r\n      case 502:\r\n      case 503:\r\n      case 504:\r\n        return new ServerError(errorMessage, data, status);\r\n      default:\r\n        if (status >= 400 && status < 500) {\r\n          return new ValidationError(errorMessage, data);\r\n        }\r\n        if (status >= 500) {\r\n          return new ServerError(errorMessage, data, status);\r\n        }\r\n        return new NfeError(errorMessage, data, status);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Create error from fetch/network issues\r\n   */\r\n  static fromNetworkError(error: Error): NfeError {\r\n    if (error.name === 'AbortError' || error.message.includes('timeout')) {\r\n      return new TimeoutError('Request timeout', error);\r\n    }\r\n\r\n    if (error.message.includes('fetch')) {\r\n      return new ConnectionError('Network connection failed', error);\r\n    }\r\n\r\n    return new ConnectionError('Connection error', error);\r\n  }\r\n\r\n  /**\r\n   * Create error from Node.js version check\r\n   */\r\n  static fromNodeVersionError(nodeVersion: string): ConfigurationError {\r\n    return new ConfigurationError(\r\n      `NFE.io SDK v3 requires Node.js 18+ (for native fetch support). Current version: ${nodeVersion}`,\r\n      { nodeVersion, requiredVersion: '>=18.0.0' }\r\n    );\r\n  }\r\n\r\n  /**\r\n   * Create error from missing API key\r\n   */\r\n  static fromMissingApiKey(): ConfigurationError {\r\n    return new ConfigurationError(\r\n      'API key is required. Pass it in NfeConfig or set NFE_API_KEY environment variable.',\r\n      { configField: 'apiKey' }\r\n    );\r\n  }\r\n\r\n  private static getDefaultMessage(status: number): string {\r\n    const messages: Record<number, string> = {\r\n      400: 'Invalid request data',\r\n      401: 'Invalid API key or authentication failed',\r\n      403: 'Access forbidden',\r\n      404: 'Resource not found',\r\n      409: 'Resource conflict',\r\n      429: 'Rate limit exceeded',\r\n      500: 'Internal server error',\r\n      502: 'Bad gateway',\r\n      503: 'Service unavailable',\r\n      504: 'Gateway timeout',\r\n    };\r\n\r\n    return messages[status] || `HTTP ${status} error`;\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Error Type Guards\r\n// ============================================================================\r\n\r\nexport function isNfeError(error: unknown): error is NfeError {\r\n  return error instanceof NfeError;\r\n}\r\n\r\nexport function isAuthenticationError(error: unknown): error is AuthenticationError {\r\n  return error instanceof AuthenticationError;\r\n}\r\n\r\nexport function isValidationError(error: unknown): error is ValidationError {\r\n  return error instanceof ValidationError;\r\n}\r\n\r\nexport function isNotFoundError(error: unknown): error is NotFoundError {\r\n  return error instanceof NotFoundError;\r\n}\r\n\r\nexport function isConnectionError(error: unknown): error is ConnectionError {\r\n  return error instanceof ConnectionError;\r\n}\r\n\r\nexport function isTimeoutError(error: unknown): error is TimeoutError {\r\n  return error instanceof TimeoutError;\r\n}\r\n\r\nexport function isPollingTimeoutError(error: unknown): error is PollingTimeoutError {\r\n  return error instanceof PollingTimeoutError;\r\n}\r\n\r\n// ============================================================================\r\n// Legacy Aliases (for v2 compatibility)\r\n// ============================================================================\r\n\r\n/** @deprecated Use ValidationError instead */\r\nexport const BadRequestError = ValidationError;\r\n\r\n/** @deprecated Use NfeError instead */\r\nexport const APIError = NfeError;\r\n\r\n/** @deprecated Use ServerError instead */\r\nexport const InternalServerError = ServerError;\r\n\r\n// Export all error types\r\nexport const ErrorTypes = {\r\n  NfeError,\r\n  AuthenticationError,\r\n  ValidationError,\r\n  NotFoundError,\r\n  ConflictError,\r\n  RateLimitError,\r\n  ServerError,\r\n  ConnectionError,\r\n  TimeoutError,\r\n  ConfigurationError,\r\n  PollingTimeoutError,\r\n  InvoiceProcessingError,\r\n  // Legacy aliases\r\n  BadRequestError,\r\n  APIError,\r\n  InternalServerError,\r\n} as const;\r\n\r\nexport type ErrorType = keyof typeof ErrorTypes;","/**\r\n * NFE.io SDK v3 - HTTP Client with Fetch API\r\n * \r\n * Modern HTTP client using native fetch (Node.js 18+)  \r\n * Zero external dependencies with automatic retries and proper error handling\r\n */\r\n\r\nimport type { HttpConfig, HttpResponse, RetryConfig } from '../types.js';\r\nimport { \r\n  ErrorFactory, \r\n  ConnectionError, \r\n  TimeoutError, \r\n  RateLimitError,\r\n  type NfeError \r\n} from '../errors/index.js';\r\n\r\n// Simple type declarations for runtime APIs\r\ndeclare const fetch: any;\r\ndeclare const AbortController: any;\r\ndeclare const URLSearchParams: any;\r\ndeclare const FormData: any;\r\ndeclare const setTimeout: any;\r\ndeclare const clearTimeout: any;\r\ndeclare const Buffer: any;\r\ndeclare const process: any;\r\n\r\n// ============================================================================\r\n// HTTP Client Implementation\r\n// ============================================================================\r\n\r\nexport class HttpClient {\r\n  private readonly config: HttpConfig;\r\n\r\n  constructor(config: HttpConfig) {\r\n    this.config = config;\r\n    this.validateFetchSupport();\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Public HTTP Methods\r\n  // --------------------------------------------------------------------------\r\n\r\n  async get<T = unknown>(path: string, params?: Record<string, unknown>): Promise<HttpResponse<T>> {\r\n    const url = this.buildUrl(path, params);\r\n    return this.request<T>('GET', url);\r\n  }\r\n\r\n  async post<T = unknown>(path: string, data?: unknown): Promise<HttpResponse<T>> {\r\n    const url = this.buildUrl(path);\r\n    return this.request<T>('POST', url, data);\r\n  }\r\n\r\n  async put<T = unknown>(path: string, data?: unknown): Promise<HttpResponse<T>> {\r\n    const url = this.buildUrl(path);\r\n    return this.request<T>('PUT', url, data);\r\n  }\r\n\r\n  async delete<T = unknown>(path: string): Promise<HttpResponse<T>> {\r\n    const url = this.buildUrl(path);\r\n    return this.request<T>('DELETE', url);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Core Request Method with Retry Logic\r\n  // --------------------------------------------------------------------------\r\n\r\n  private async request<T>(\r\n    method: string, \r\n    url: string, \r\n    data?: unknown\r\n  ): Promise<HttpResponse<T>> {\r\n    const { maxRetries, baseDelay } = this.config.retryConfig;\r\n    let lastError: NfeError | undefined;\r\n\r\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\r\n      try {\r\n        const response = await this.executeRequest<T>(method, url, data);\r\n        return response;\r\n      } catch (error) {\r\n        lastError = error as NfeError;\r\n\r\n        // Don't retry on client errors (4xx) except rate limits\r\n        if (this.shouldNotRetry(lastError, attempt, maxRetries)) {\r\n          throw lastError;\r\n        }\r\n\r\n        // Wait before retry (exponential backoff)\r\n        if (attempt < maxRetries) {\r\n          const delay = this.calculateRetryDelay(attempt, baseDelay);\r\n          await this.sleep(delay);\r\n        }\r\n      }\r\n    }\r\n\r\n    throw lastError || new ConnectionError('Request failed after all retries');\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Single Request Execution\r\n  // --------------------------------------------------------------------------\r\n\r\n  private async executeRequest<T>(\r\n    method: string,\r\n    url: string,\r\n    data?: unknown\r\n  ): Promise<HttpResponse<T>> {\r\n    const controller = new AbortController();\r\n    const timeoutId = setTimeout(() => controller.abort(), this.config.timeout);\r\n\r\n    try {\r\n      const headers = this.buildHeaders(data);\r\n      const body = this.buildBody(data);\r\n\r\n      const response = await fetch(url, {\r\n        method: method.toUpperCase(),\r\n        headers,\r\n        body,\r\n        signal: controller.signal,\r\n      });\r\n\r\n      clearTimeout(timeoutId);\r\n\r\n      return await this.processResponse<T>(response);\r\n\r\n    } catch (error) {\r\n      clearTimeout(timeoutId);\r\n\r\n      if (error instanceof Error) {\r\n        if (error.name === 'AbortError') {\r\n          throw new TimeoutError(`Request timeout after ${this.config.timeout}ms`, error);\r\n        }\r\n        throw ErrorFactory.fromNetworkError(error);\r\n      }\r\n\r\n      throw new ConnectionError('Unknown network error', error);\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Response Processing\r\n  // --------------------------------------------------------------------------\r\n\r\n  private async processResponse<T>(response: any): Promise<HttpResponse<T>> {\r\n    // Special handling for NFE.io async responses (202 with location)\r\n    if (response.status === 202) {\r\n      const location = response.headers.get('location');\r\n      if (location) {\r\n        return {\r\n          data: {\r\n            code: 202,\r\n            status: 'pending',\r\n            location\r\n          } as T,\r\n          status: response.status,\r\n          headers: this.extractHeaders(response)\r\n        };\r\n      }\r\n    }\r\n\r\n    // Handle error responses\r\n    if (!response.ok) {\r\n      await this.handleErrorResponse(response);\r\n    }\r\n\r\n    // Parse successful response\r\n    const data = await this.parseResponseData<T>(response);\r\n\r\n    return {\r\n      data,\r\n      status: response.status,\r\n      headers: this.extractHeaders(response)\r\n    };\r\n  }\r\n\r\n  private async parseResponseData<T>(response: any): Promise<T> {\r\n    const contentType = response.headers.get('content-type') || '';\r\n\r\n    if (contentType.includes('application/json')) {\r\n      return response.json() as Promise<T>;\r\n    }\r\n\r\n    if (contentType.includes('application/pdf') || contentType.includes('application/xml')) {\r\n      const buffer = await response.arrayBuffer();\r\n      return Buffer.from(buffer) as unknown as T;\r\n    }\r\n\r\n    // Default to text\r\n    return response.text() as unknown as T;\r\n  }\r\n\r\n  private async handleErrorResponse(response: any): Promise<never> {\r\n    let errorData: unknown;\r\n    \r\n    try {\r\n      const contentType = response.headers.get('content-type') || '';\r\n      if (contentType.includes('application/json')) {\r\n        errorData = await response.json();\r\n      } else {\r\n        errorData = await response.text();\r\n      }\r\n    } catch {\r\n      // Ignore parse errors, use status as fallback\r\n      errorData = { status: response.status, statusText: response.statusText };\r\n    }\r\n\r\n    // Extract error message from response data\r\n    const message = this.extractErrorMessage(errorData, response.status);\r\n    \r\n    throw ErrorFactory.fromHttpResponse(response.status, errorData, message);\r\n  }\r\n\r\n  private extractErrorMessage(data: unknown, status: number): string {\r\n    if (typeof data === 'object' && data !== null) {\r\n      const errorObj = data as Record<string, unknown>;\r\n      \r\n      // Try common error message fields\r\n      if (typeof errorObj.message === 'string') return errorObj.message;\r\n      if (typeof errorObj.error === 'string') return errorObj.error;\r\n      if (typeof errorObj.detail === 'string') return errorObj.detail;\r\n      if (typeof errorObj.details === 'string') return errorObj.details;\r\n    }\r\n\r\n    if (typeof data === 'string') {\r\n      return data;\r\n    }\r\n\r\n    return `HTTP ${status} error`;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // URL and Header Building\r\n  // --------------------------------------------------------------------------\r\n\r\n  private buildUrl(path: string, params?: Record<string, unknown>): string {\r\n    const baseUrl = this.config.baseUrl.replace(/\\/$/, ''); // Remove trailing slash\r\n    const cleanPath = path.replace(/^\\//, ''); // Remove leading slash\r\n    let url = `${baseUrl}/${cleanPath}`;\r\n\r\n    if (params && Object.keys(params).length > 0) {\r\n      const searchParams = new URLSearchParams();\r\n      for (const [key, value] of Object.entries(params)) {\r\n        if (value !== undefined && value !== null) {\r\n          searchParams.append(key, String(value));\r\n        }\r\n      }\r\n      const queryString = searchParams.toString();\r\n      if (queryString) {\r\n        url += `?${queryString}`;\r\n      }\r\n    }\r\n\r\n    return url;\r\n  }\r\n\r\n  private buildHeaders(data?: unknown): Record<string, string> {\r\n    const headers: Record<string, string> = {\r\n      'Authorization': `Basic ${Buffer.from(this.config.apiKey).toString('base64')}`,\r\n      'Accept': 'application/json',\r\n      'User-Agent': this.getUserAgent(),\r\n    };\r\n\r\n    // Add Content-Type for requests with body (but not FormData)\r\n    if (data !== undefined && data !== null && !this.isFormData(data)) {\r\n      headers['Content-Type'] = 'application/json';\r\n    }\r\n\r\n    return headers;\r\n  }\r\n\r\n  private buildBody(data?: unknown): string | any | undefined {\r\n    if (data === undefined || data === null) {\r\n      return undefined;\r\n    }\r\n\r\n    // Handle FormData (for file uploads)\r\n    if (this.isFormData(data)) {\r\n      return data as any;\r\n    }\r\n\r\n    // Default to JSON\r\n    return JSON.stringify(data);\r\n  }\r\n\r\n  private isFormData(data: unknown): boolean {\r\n    return typeof FormData !== 'undefined' && data instanceof FormData;\r\n  }\r\n\r\n  private getUserAgent(): string {\r\n    const nodeVersion = process.version;\r\n    const platform = process.platform;\r\n    \r\n    // Try to get package version (will be undefined in development)\r\n    const packageVersion = '3.0.0-beta.1'; // TODO: Read from package.json\r\n    \r\n    return `@nfe-io/sdk@${packageVersion} node/${nodeVersion} (${platform})`;\r\n  }\r\n\r\n  private extractHeaders(response: any): Record<string, string> {\r\n    const headers: Record<string, string> = {};\r\n    response.headers.forEach((value: any, key: any) => {\r\n      headers[key] = value;\r\n    });\r\n    return headers;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Retry Logic\r\n  // --------------------------------------------------------------------------\r\n\r\n  private shouldNotRetry(error: NfeError, attempt: number, maxRetries: number): boolean {\r\n    // Don't retry if we've exhausted attempts\r\n    if (attempt >= maxRetries) {\r\n      return true;\r\n    }\r\n\r\n    // Always retry rate limits (with backoff)\r\n    if (error instanceof RateLimitError) {\r\n      return false;\r\n    }\r\n\r\n    // Don't retry client errors (4xx) - these are permanent errors\r\n    if (error.code && error.code >= 400 && error.code < 500) {\r\n      return true; // Don't retry any 4xx errors\r\n    }\r\n\r\n    // Retry server errors (5xx) and network errors\r\n    return false;\r\n  }\r\n\r\n  private calculateRetryDelay(attempt: number, baseDelay: number): number {\r\n    const { maxDelay = 30000, backoffMultiplier = 2 } = this.config.retryConfig;\r\n    \r\n    // Exponential backoff with jitter\r\n    const exponentialDelay = baseDelay * Math.pow(backoffMultiplier, attempt);\r\n    const jitter = Math.random() * 0.1 * exponentialDelay; // 10% jitter\r\n    \r\n    return Math.min(exponentialDelay + jitter, maxDelay);\r\n  }\r\n\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Validation\r\n  // --------------------------------------------------------------------------\r\n\r\n  private validateFetchSupport(): void {\r\n    if (typeof fetch === 'undefined') {\r\n      throw ErrorFactory.fromNodeVersionError(process.version);\r\n    }\r\n\r\n    if (typeof AbortController === 'undefined') {\r\n      throw new ConnectionError(\r\n        'AbortController is not available. This should not happen in Node.js 18+.'\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// HTTP Client Factory\r\n// ============================================================================\r\n\r\nexport function createHttpClient(config: HttpConfig): HttpClient {\r\n  return new HttpClient(config);\r\n}\r\n\r\n// ============================================================================\r\n// Utility Functions\r\n// ============================================================================\r\n\r\n/**\r\n * Create default retry configuration\r\n */\r\nexport function createDefaultRetryConfig(): RetryConfig {\r\n  return {\r\n    maxRetries: 3,\r\n    baseDelay: 1000,\r\n    maxDelay: 30000,\r\n    backoffMultiplier: 2,\r\n  };\r\n}\r\n\r\n/**\r\n * Build HTTP config from SDK config\r\n */\r\nexport function buildHttpConfig(apiKey: string, baseUrl: string, timeout: number, retryConfig: RetryConfig): HttpConfig {\r\n  return {\r\n    apiKey,\r\n    baseUrl,\r\n    timeout,\r\n    retryConfig,\r\n  };\r\n}","/**\r\n * NFE.io SDK v3 - Service Invoices Resource\r\n * \r\n * Handles service invoice operations (NFS-e)\r\n * This is the core functionality of NFE.io API\r\n */\r\n\r\nimport type { \r\n  ServiceInvoice, \r\n  ServiceInvoiceData, \r\n  ListResponse, \r\n  PaginationOptions,\r\n  AsyncResponse\r\n} from '../types.js';\r\nimport type { HttpClient } from '../http/client.js';\r\nimport { InvoiceProcessingError } from '../errors/index.js';\r\n\r\n// ============================================================================\r\n// Service Invoices Resource\r\n// ============================================================================\r\n\r\nexport class ServiceInvoicesResource {\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Core CRUD Operations\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Create a new service invoice\r\n   * Returns 202 + location for async processing (NFE.io pattern)\r\n   */\r\n  async create(\r\n    companyId: string, \r\n    data: ServiceInvoiceData\r\n  ): Promise<ServiceInvoice | AsyncResponse> {\r\n    const path = `/companies/${companyId}/serviceinvoices`;\r\n    const response = await this.http.post<ServiceInvoice | AsyncResponse>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * List service invoices for a company\r\n   */\r\n  async list(\r\n    companyId: string, \r\n    options: PaginationOptions = {}\r\n  ): Promise<ListResponse<ServiceInvoice>> {\r\n    const path = `/companies/${companyId}/serviceinvoices`;\r\n    const response = await this.http.get<ListResponse<ServiceInvoice>>(path, options);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Retrieve a specific service invoice\r\n   */\r\n  async retrieve(companyId: string, invoiceId: string): Promise<ServiceInvoice> {\r\n    const path = `/companies/${companyId}/serviceinvoices/${invoiceId}`;\r\n    const response = await this.http.get<ServiceInvoice>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Cancel a service invoice\r\n   */\r\n  async cancel(companyId: string, invoiceId: string): Promise<ServiceInvoice> {\r\n    const path = `/companies/${companyId}/serviceinvoices/${invoiceId}`;\r\n    const response = await this.http.delete<ServiceInvoice>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Email Operations\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Send invoice via email\r\n   */\r\n  async sendEmail(companyId: string, invoiceId: string): Promise<{ sent: boolean; message?: string }> {\r\n    const path = `/companies/${companyId}/serviceinvoices/${invoiceId}/sendemail`;\r\n    const response = await this.http.put<{ sent: boolean; message?: string }>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // File Downloads\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Download invoice PDF\r\n   */\r\n  async downloadPdf(companyId: string, invoiceId?: string): Promise<any> {\r\n    let path: string;\r\n    \r\n    if (invoiceId) {\r\n      path = `/companies/${companyId}/serviceinvoices/${invoiceId}/pdf`;\r\n    } else {\r\n      // Bulk download for company\r\n      path = `/companies/${companyId}/serviceinvoices/pdf`;\r\n    }\r\n    \r\n    const response = await this.http.get<any>(path);\r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Download invoice XML\r\n   */\r\n  async downloadXml(companyId: string, invoiceId?: string): Promise<any> {\r\n    let path: string;\r\n    \r\n    if (invoiceId) {\r\n      path = `/companies/${companyId}/serviceinvoices/${invoiceId}/xml`;\r\n    } else {\r\n      // Bulk download for company\r\n      path = `/companies/${companyId}/serviceinvoices/xml`;\r\n    }\r\n    \r\n    const response = await this.http.get<any>(path);\r\n    return response.data;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // High-level Convenience Methods\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Create invoice and wait for completion (handles async processing)\r\n   */\r\n  async createAndWait(\r\n    companyId: string, \r\n    data: ServiceInvoiceData,\r\n    options: { \r\n      maxAttempts?: number; \r\n      intervalMs?: number; \r\n      timeoutMs?: number \r\n    } = {}\r\n  ): Promise<ServiceInvoice> {\r\n    const { maxAttempts = 30, intervalMs = 2000, timeoutMs = 60000 } = options;\r\n    \r\n    // Create invoice\r\n    const createResult = await this.create(companyId, data);\r\n    \r\n    // If synchronous response (unusual for NFE.io), return immediately\r\n    if ('id' in createResult && createResult.id) {\r\n      return createResult as ServiceInvoice;\r\n    }\r\n    \r\n    // Handle async response (202 + location)\r\n    const asyncResult = createResult as AsyncResponse;\r\n    if (asyncResult.code !== 202 || !asyncResult.location) {\r\n      throw new InvoiceProcessingError(\r\n        'Unexpected response from invoice creation',\r\n        createResult\r\n      );\r\n    }\r\n    \r\n    // Poll for completion using the injected polling logic\r\n    return this.pollInvoiceCompletion(asyncResult.location, {\r\n      maxAttempts,\r\n      intervalMs,\r\n      timeoutMs,\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Get invoice status (high-level wrapper)\r\n   */\r\n  async getStatus(companyId: string, invoiceId: string): Promise<{\r\n    status: string;\r\n    invoice: ServiceInvoice;\r\n    isComplete: boolean;\r\n    isFailed: boolean;\r\n  }> {\r\n    const invoice = await this.retrieve(companyId, invoiceId);\r\n    \r\n    return {\r\n      status: invoice.status,\r\n      invoice,\r\n      isComplete: ['issued', 'completed'].includes(invoice.status),\r\n      isFailed: ['failed', 'cancelled', 'error'].includes(invoice.status),\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Bulk operations: Create multiple invoices\r\n   */\r\n  async createBatch(\r\n    companyId: string,\r\n    invoices: ServiceInvoiceData[],\r\n    options: { \r\n      waitForCompletion?: boolean;\r\n      maxConcurrent?: number;\r\n    } = {}\r\n  ): Promise<Array<ServiceInvoice | AsyncResponse>> {\r\n    const { waitForCompletion = false, maxConcurrent = 5 } = options;\r\n    \r\n    // Process in batches to avoid overwhelming the API\r\n    const results: Array<ServiceInvoice | AsyncResponse> = [];\r\n    \r\n    for (let i = 0; i < invoices.length; i += maxConcurrent) {\r\n      const batch = invoices.slice(i, i + maxConcurrent);\r\n      \r\n      const batchPromises = batch.map(async (invoiceData) => {\r\n        if (waitForCompletion) {\r\n          return this.createAndWait(companyId, invoiceData);\r\n        } else {\r\n          return this.create(companyId, invoiceData);\r\n        }\r\n      });\r\n      \r\n      const batchResults = await Promise.all(batchPromises);\r\n      results.push(...batchResults);\r\n    }\r\n    \r\n    return results;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Private Helper Methods\r\n  // --------------------------------------------------------------------------\r\n\r\n  private async pollInvoiceCompletion(\r\n    locationUrl: string,\r\n    options: { maxAttempts: number; intervalMs: number; timeoutMs: number }\r\n  ): Promise<ServiceInvoice> {\r\n    const { maxAttempts, intervalMs, timeoutMs } = options;\r\n    const startTime = Date.now();\r\n    \r\n    for (let attempt = 0; attempt < maxAttempts; attempt++) {\r\n      // Check timeout\r\n      if (Date.now() - startTime > timeoutMs) {\r\n        throw new InvoiceProcessingError(\r\n          `Invoice processing timeout after ${timeoutMs}ms`,\r\n          { locationUrl, attempt, timeoutMs }\r\n        );\r\n      }\r\n      \r\n      // Wait before polling (except first attempt)\r\n      if (attempt > 0) {\r\n        await this.sleep(intervalMs);\r\n      }\r\n      \r\n      try {\r\n        // Extract path from location URL\r\n        const path = this.extractPathFromLocationUrl(locationUrl);\r\n        const response = await this.http.get<ServiceInvoice>(path);\r\n        const invoice = response.data;\r\n        \r\n        // Check if processing is complete\r\n        if (this.isInvoiceComplete(invoice)) {\r\n          return invoice;\r\n        }\r\n        \r\n        // Check if processing failed\r\n        if (this.isInvoiceFailed(invoice)) {\r\n          throw new InvoiceProcessingError(\r\n            `Invoice processing failed: ${invoice.status}`,\r\n            invoice\r\n          );\r\n        }\r\n        \r\n        // Continue polling\r\n        \r\n      } catch (error) {\r\n        // If it's the last attempt, throw the error\r\n        if (attempt === maxAttempts - 1) {\r\n          throw new InvoiceProcessingError(\r\n            'Failed to poll invoice completion',\r\n            { error, locationUrl, attempt }\r\n          );\r\n        }\r\n        \r\n        // For other attempts, continue (might be temporary issue)\r\n      }\r\n    }\r\n    \r\n    throw new InvoiceProcessingError(\r\n      `Invoice processing timeout after ${maxAttempts} polling attempts`,\r\n      { locationUrl, maxAttempts, intervalMs }\r\n    );\r\n  }\r\n\r\n  private extractPathFromLocationUrl(url: string): string {\r\n    try {\r\n      const urlObj = new URL(url);\r\n      return urlObj.pathname + urlObj.search;\r\n    } catch {\r\n      // If URL parsing fails, assume it's already a path\r\n      return url.startsWith('/') ? url : `/${url}`;\r\n    }\r\n  }\r\n\r\n  private isInvoiceComplete(invoice: ServiceInvoice): boolean {\r\n    return ['issued', 'completed'].includes(invoice.status);\r\n  }\r\n\r\n  private isInvoiceFailed(invoice: ServiceInvoice): boolean {\r\n    return ['failed', 'cancelled', 'error'].includes(invoice.status);\r\n  }\r\n\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Factory Function\r\n// ============================================================================\r\n\r\nexport function createServiceInvoicesResource(http: HttpClient): ServiceInvoicesResource {\r\n  return new ServiceInvoicesResource(http);\r\n}","/**\r\n * NFE.io SDK v3 - Companies Resource\r\n * \r\n * Handles company operations and certificate management\r\n */\r\n\r\nimport type { \r\n  Company, \r\n  ListResponse, \r\n  PaginationOptions \r\n} from '../types.js';\r\nimport type { HttpClient } from '../http/client.js';\r\n\r\n// ============================================================================\r\n// Companies Resource\r\n// ============================================================================\r\n\r\nexport class CompaniesResource {\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Core CRUD Operations\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Create a new company\r\n   */\r\n  async create(data: Omit<Company, 'id' | 'createdOn' | 'modifiedOn'>): Promise<Company> {\r\n    const path = '/companies';\r\n    const response = await this.http.post<Company>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * List companies\r\n   */\r\n  async list(options: PaginationOptions = {}): Promise<ListResponse<Company>> {\r\n    const path = '/companies';\r\n    const response = await this.http.get<ListResponse<Company>>(path, options);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Retrieve a specific company\r\n   */\r\n  async retrieve(companyId: string): Promise<Company> {\r\n    const path = `/companies/${companyId}`;\r\n    const response = await this.http.get<Company>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Update a company\r\n   */\r\n  async update(companyId: string, data: Partial<Company>): Promise<Company> {\r\n    const path = `/companies/${companyId}`;\r\n    const response = await this.http.put<Company>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Delete a company (named 'remove' to avoid JS keyword conflict)\r\n   */\r\n  async remove(companyId: string): Promise<{ deleted: boolean; id: string }> {\r\n    const path = `/companies/${companyId}`;\r\n    const response = await this.http.delete<{ deleted: boolean; id: string }>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Certificate Management\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Upload digital certificate for a company\r\n   * Handles FormData for file upload\r\n   */\r\n  async uploadCertificate(\r\n    companyId: string, \r\n    certificateData: {\r\n      /** Certificate file (Buffer or Blob) */\r\n      file: any;\r\n      /** Certificate password */\r\n      password: string;\r\n      /** Optional filename */\r\n      filename?: string;\r\n    }\r\n  ): Promise<{ uploaded: boolean; message?: string }> {\r\n    const path = `/companies/${companyId}/certificate`;\r\n    \r\n    // Create FormData for file upload\r\n    const formData = this.createFormData();\r\n    \r\n    // Add certificate file\r\n    if (certificateData.filename) {\r\n      formData.append('certificate', certificateData.file, certificateData.filename);\r\n    } else {\r\n      formData.append('certificate', certificateData.file);\r\n    }\r\n    \r\n    // Add password\r\n    formData.append('password', certificateData.password);\r\n    \r\n    const response = await this.http.post<{ uploaded: boolean; message?: string }>(\r\n      path, \r\n      formData\r\n    );\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Get certificate status for a company\r\n   */\r\n  async getCertificateStatus(companyId: string): Promise<{\r\n    hasCertificate: boolean;\r\n    expiresOn?: string;\r\n    isValid?: boolean;\r\n    details?: any;\r\n  }> {\r\n    const path = `/companies/${companyId}/certificate`;\r\n    const response = await this.http.get<{\r\n      hasCertificate: boolean;\r\n      expiresOn?: string;\r\n      isValid?: boolean;\r\n      details?: any;\r\n    }>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // High-level Convenience Methods\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Find company by CNPJ/CPF\r\n   */\r\n  async findByTaxNumber(taxNumber: number): Promise<Company | null> {\r\n    const companies = await this.list({ pageCount: 100 }); // Get reasonable batch\r\n    \r\n    return companies.data.find(company => \r\n      company.federalTaxNumber === taxNumber\r\n    ) || null;\r\n  }\r\n\r\n  /**\r\n   * Get companies with active certificates\r\n   */\r\n  async getCompaniesWithCertificates(): Promise<Company[]> {\r\n    const companies = await this.list({ pageCount: 100 });\r\n    \r\n    const companiesWithCerts: Company[] = [];\r\n    \r\n    // Check certificate status for each company\r\n    for (const company of companies.data) {\r\n      try {\r\n        const certStatus = await this.getCertificateStatus(company.id!);\r\n        if (certStatus.hasCertificate && certStatus.isValid) {\r\n          companiesWithCerts.push(company);\r\n        }\r\n      } catch {\r\n        // Skip companies where we can't check certificate status\r\n        continue;\r\n      }\r\n    }\r\n    \r\n    return companiesWithCerts;\r\n  }\r\n\r\n  /**\r\n   * Bulk create companies\r\n   */\r\n  async createBatch(\r\n    companies: Array<Omit<Company, 'id' | 'createdOn' | 'modifiedOn'>>,\r\n    options: { \r\n      maxConcurrent?: number;\r\n      continueOnError?: boolean;\r\n    } = {}\r\n  ): Promise<Array<Company | { error: string; data: any }>> {\r\n    const { maxConcurrent = 3, continueOnError = true } = options;\r\n    \r\n    const results: Array<Company | { error: string; data: any }> = [];\r\n    \r\n    // Process in batches to avoid overwhelming the API\r\n    for (let i = 0; i < companies.length; i += maxConcurrent) {\r\n      const batch = companies.slice(i, i + maxConcurrent);\r\n      \r\n      const batchPromises = batch.map(async (companyData) => {\r\n        try {\r\n          return await this.create(companyData);\r\n        } catch (error) {\r\n          if (continueOnError) {\r\n            return {\r\n              error: error instanceof Error ? error.message : 'Unknown error',\r\n              data: companyData\r\n            };\r\n          } else {\r\n            throw error;\r\n          }\r\n        }\r\n      });\r\n      \r\n      const batchResults = await Promise.all(batchPromises);\r\n      results.push(...batchResults);\r\n    }\r\n    \r\n    return results;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Private Helper Methods  \r\n  // --------------------------------------------------------------------------\r\n\r\n  private createFormData(): any {\r\n    if (typeof FormData !== 'undefined') {\r\n      return new FormData();\r\n    } else {\r\n      // Fallback for environments without FormData\r\n      throw new Error('FormData is not available in this environment');\r\n    }\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Factory Function\r\n// ============================================================================\r\n\r\nexport function createCompaniesResource(http: HttpClient): CompaniesResource {\r\n  return new CompaniesResource(http);\r\n}","/**\r\n * LegalPeople Resource\r\n * Manages legal entities (pessoas jurdicas) scoped by company\r\n */\r\n\r\nimport type { HttpClient } from '../http/client.js';\r\nimport type { LegalPerson, ListResponse, ResourceId } from '../types.js';\r\n\r\n/**\r\n * LegalPeople resource for managing legal entities (pessoas jurdicas)\r\n * All operations are scoped by company_id\r\n */\r\nexport class LegalPeopleResource {\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  /**\r\n   * List all legal people for a company\r\n   * \r\n   * @param companyId - Company ID\r\n   * @returns List of legal people\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const result = await nfe.legalPeople.list('company-id');\r\n   * console.log(`Found ${result.legalPeople.length} legal entities`);\r\n   * ```\r\n   */\r\n  async list(companyId: ResourceId): Promise<ListResponse<LegalPerson>> {\r\n    const path = `/companies/${companyId}/legalpeople`;\r\n    const response = await this.http.get<ListResponse<LegalPerson>>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Create a new legal person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param data - Legal person data\r\n   * @returns Created legal person\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const legalPerson = await nfe.legalPeople.create('company-id', {\r\n   *   federalTaxNumber: '12345678901234',\r\n   *   name: 'Empresa Exemplo Ltda',\r\n   *   email: 'contato@empresa.com.br',\r\n   *   address: {\r\n   *     street: 'Av. Paulista, 1000',\r\n   *     neighborhood: 'Bela Vista',\r\n   *     city: { code: '3550308', name: 'So Paulo' },\r\n   *     state: 'SP',\r\n   *     postalCode: '01310-100'\r\n   *     }\r\n   * });\r\n   * ```\r\n   */\r\n  async create(\r\n    companyId: ResourceId,\r\n    data: Partial<LegalPerson>\r\n  ): Promise<LegalPerson> {\r\n    const path = `/companies/${companyId}/legalpeople`;\r\n    const response = await this.http.post<LegalPerson>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Retrieve a specific legal person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param legalPersonId - Legal person ID\r\n   * @returns Legal person details\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const legalPerson = await nfe.legalPeople.retrieve(\r\n   *   'company-id',\r\n   *   'legal-person-id'\r\n   * );\r\n   * console.log(legalPerson.name);\r\n   * ```\r\n   */\r\n  async retrieve(\r\n    companyId: ResourceId,\r\n    legalPersonId: ResourceId\r\n  ): Promise<LegalPerson> {\r\n    const path = `/companies/${companyId}/legalpeople/${legalPersonId}`;\r\n    const response = await this.http.get<LegalPerson>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Update a legal person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param legalPersonId - Legal person ID\r\n   * @param data - Data to update\r\n   * @returns Updated legal person\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const updated = await nfe.legalPeople.update(\r\n   *   'company-id',\r\n   *   'legal-person-id',\r\n   *   { email: 'novo@email.com' }\r\n   * );\r\n   * ```\r\n   */\r\n  async update(\r\n    companyId: ResourceId,\r\n    legalPersonId: ResourceId,\r\n    data: Partial<LegalPerson>\r\n  ): Promise<LegalPerson> {\r\n    const path = `/companies/${companyId}/legalpeople/${legalPersonId}`;\r\n    const response = await this.http.put<LegalPerson>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Delete a legal person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param legalPersonId - Legal person ID\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * await nfe.legalPeople.delete('company-id', 'legal-person-id');\r\n   * ```\r\n   */\r\n  async delete(\r\n    companyId: ResourceId,\r\n    legalPersonId: ResourceId\r\n  ): Promise<void> {\r\n    const path = `/companies/${companyId}/legalpeople/${legalPersonId}`;\r\n    await this.http.delete(path);\r\n  }\r\n\r\n  /**\r\n   * Create multiple legal people in batch\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param data - Array of legal people data\r\n   * @returns Array of created legal people\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const created = await nfe.legalPeople.createBatch('company-id', [\r\n   *   { name: 'Empresa 1', federalTaxNumber: '11111111111111', ... },\r\n   *   { name: 'Empresa 2', federalTaxNumber: '22222222222222', ... }\r\n   * ]);\r\n   * ```\r\n   */\r\n  async createBatch(\r\n    companyId: ResourceId,\r\n    data: Array<Partial<LegalPerson>>\r\n  ): Promise<LegalPerson[]> {\r\n    const promises = data.map(person => this.create(companyId, person));\r\n    return Promise.all(promises);\r\n  }\r\n\r\n  /**\r\n   * Find legal person by federal tax number (CNPJ)\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param federalTaxNumber - CNPJ (only numbers)\r\n   * @returns Legal person or undefined if not found\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const person = await nfe.legalPeople.findByTaxNumber(\r\n   *   'company-id',\r\n   *   '12345678901234'\r\n   * );\r\n   * if (person) {\r\n   *   console.log('Found:', person.name);\r\n   * }\r\n   * ```\r\n   */\r\n  async findByTaxNumber(\r\n    companyId: ResourceId,\r\n    federalTaxNumber: string\r\n  ): Promise<LegalPerson | undefined> {\r\n    const result = await this.list(companyId);\r\n    return result.data?.find(\r\n      (person: LegalPerson) => \r\n        person.federalTaxNumber?.toString() === federalTaxNumber\r\n    );\r\n  }\r\n}\r\n","/**\r\n * NaturalPeople Resource\r\n * Manages natural persons (pessoas fsicas) scoped by company\r\n */\r\n\r\nimport type { HttpClient } from '../http/client.js';\r\nimport type { NaturalPerson, ListResponse, ResourceId } from '../types.js';\r\n\r\n/**\r\n * NaturalPeople resource for managing natural persons (pessoas fsicas)\r\n * All operations are scoped by company_id\r\n */\r\nexport class NaturalPeopleResource {\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  /**\r\n   * List all natural people for a company\r\n   * \r\n   * @param companyId - Company ID\r\n   * @returns List of natural people\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const result = await nfe.naturalPeople.list('company-id');\r\n   * console.log(`Found ${result.data.length} natural persons`);\r\n   * ```\r\n   */\r\n  async list(companyId: ResourceId): Promise<ListResponse<NaturalPerson>> {\r\n    const path = `/companies/${companyId}/naturalpeople`;\r\n    const response = await this.http.get<ListResponse<NaturalPerson>>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Create a new natural person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param data - Natural person data\r\n   * @returns Created natural person\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const naturalPerson = await nfe.naturalPeople.create('company-id', {\r\n   *   federalTaxNumber: '12345678901',\r\n   *   name: 'Joo Silva',\r\n   *   email: 'joao@exemplo.com',\r\n   *   address: {\r\n   *     street: 'Rua Exemplo, 123',\r\n   *     neighborhood: 'Centro',\r\n   *     city: { code: '3550308', name: 'So Paulo' },\r\n   *     state: 'SP',\r\n   *     postalCode: '01000-000'\r\n   *   }\r\n   * });\r\n   * ```\r\n   */\r\n  async create(\r\n    companyId: ResourceId,\r\n    data: Partial<NaturalPerson>\r\n  ): Promise<NaturalPerson> {\r\n    const path = `/companies/${companyId}/naturalpeople`;\r\n    const response = await this.http.post<NaturalPerson>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Retrieve a specific natural person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param naturalPersonId - Natural person ID\r\n   * @returns Natural person details\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const naturalPerson = await nfe.naturalPeople.retrieve(\r\n   *   'company-id',\r\n   *   'natural-person-id'\r\n   * );\r\n   * console.log(naturalPerson.name);\r\n   * ```\r\n   */\r\n  async retrieve(\r\n    companyId: ResourceId,\r\n    naturalPersonId: ResourceId\r\n  ): Promise<NaturalPerson> {\r\n    const path = `/companies/${companyId}/naturalpeople/${naturalPersonId}`;\r\n    const response = await this.http.get<NaturalPerson>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Update a natural person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param naturalPersonId - Natural person ID\r\n   * @param data - Data to update\r\n   * @returns Updated natural person\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const updated = await nfe.naturalPeople.update(\r\n   *   'company-id',\r\n   *   'natural-person-id',\r\n   *   { email: 'novo@email.com' }\r\n   * );\r\n   * ```\r\n   */\r\n  async update(\r\n    companyId: ResourceId,\r\n    naturalPersonId: ResourceId,\r\n    data: Partial<NaturalPerson>\r\n  ): Promise<NaturalPerson> {\r\n    const path = `/companies/${companyId}/naturalpeople/${naturalPersonId}`;\r\n    const response = await this.http.put<NaturalPerson>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Delete a natural person\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param naturalPersonId - Natural person ID\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * await nfe.naturalPeople.delete('company-id', 'natural-person-id');\r\n   * ```\r\n   */\r\n  async delete(\r\n    companyId: ResourceId,\r\n    naturalPersonId: ResourceId\r\n  ): Promise<void> {\r\n    const path = `/companies/${companyId}/naturalpeople/${naturalPersonId}`;\r\n    await this.http.delete(path);\r\n  }\r\n\r\n  /**\r\n   * Create multiple natural people in batch\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param data - Array of natural people data\r\n   * @returns Array of created natural people\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const created = await nfe.naturalPeople.createBatch('company-id', [\r\n   *   { name: 'Joo Silva', federalTaxNumber: '11111111111', ... },\r\n   *   { name: 'Maria Santos', federalTaxNumber: '22222222222', ... }\r\n   * ]);\r\n   * ```\r\n   */\r\n  async createBatch(\r\n    companyId: ResourceId,\r\n    data: Array<Partial<NaturalPerson>>\r\n  ): Promise<NaturalPerson[]> {\r\n    const promises = data.map(person => this.create(companyId, person));\r\n    return Promise.all(promises);\r\n  }\r\n\r\n  /**\r\n   * Find natural person by federal tax number (CPF)\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param federalTaxNumber - CPF (only numbers)\r\n   * @returns Natural person or undefined if not found\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const person = await nfe.naturalPeople.findByTaxNumber(\r\n   *   'company-id',\r\n   *   '12345678901'\r\n   * );\r\n   * if (person) {\r\n   *   console.log('Found:', person.name);\r\n   * }\r\n   * ```\r\n   */\r\n  async findByTaxNumber(\r\n    companyId: ResourceId,\r\n    federalTaxNumber: string\r\n  ): Promise<NaturalPerson | undefined> {\r\n    const result = await this.list(companyId);\r\n    return result.data?.find(\r\n      (person: NaturalPerson) => \r\n        person.federalTaxNumber?.toString() === federalTaxNumber\r\n    );\r\n  }\r\n}\r\n","/**\r\n * Webhooks Resource\r\n * Manages webhook subscriptions for event notifications\r\n */\r\n\r\nimport type { HttpClient } from '../http/client.js';\r\nimport type { Webhook, WebhookEvent, ListResponse, ResourceId } from '../types.js';\r\n\r\n/**\r\n * Webhooks resource for managing event subscriptions\r\n * All operations are scoped by company_id\r\n */\r\nexport class WebhooksResource {\r\n  constructor(private readonly http: HttpClient) {}\r\n\r\n  /**\r\n   * List all webhooks for a company\r\n   * \r\n   * @param companyId - Company ID\r\n   * @returns List of webhooks\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const result = await nfe.webhooks.list('company-id');\r\n   * console.log(`You have ${result.data.length} webhooks configured`);\r\n   * ```\r\n   */\r\n  async list(companyId: ResourceId): Promise<ListResponse<Webhook>> {\r\n    const path = `/companies/${companyId}/webhooks`;\r\n    const response = await this.http.get<ListResponse<Webhook>>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Create a new webhook subscription\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param data - Webhook configuration\r\n   * @returns Created webhook\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const webhook = await nfe.webhooks.create('company-id', {\r\n   *   url: 'https://seu-site.com/webhook/nfe',\r\n   *   events: ['invoice.issued', 'invoice.cancelled'],\r\n   *   secret: 'sua-chave-secreta-opcional'\r\n   * });\r\n   * ```\r\n   */\r\n  async create(\r\n    companyId: ResourceId,\r\n    data: Partial<Webhook>\r\n  ): Promise<Webhook> {\r\n    const path = `/companies/${companyId}/webhooks`;\r\n    const response = await this.http.post<Webhook>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Retrieve a specific webhook\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param webhookId - Webhook ID\r\n   * @returns Webhook details\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const webhook = await nfe.webhooks.retrieve('company-id', 'webhook-id');\r\n   * console.log('Webhook URL:', webhook.url);\r\n   * ```\r\n   */\r\n  async retrieve(\r\n    companyId: ResourceId,\r\n    webhookId: ResourceId\r\n  ): Promise<Webhook> {\r\n    const path = `/companies/${companyId}/webhooks/${webhookId}`;\r\n    const response = await this.http.get<Webhook>(path);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Update a webhook\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param webhookId - Webhook ID\r\n   * @param data - Data to update\r\n   * @returns Updated webhook\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const updated = await nfe.webhooks.update(\r\n   *   'company-id',\r\n   *   'webhook-id',\r\n   *   { events: ['invoice.issued', 'invoice.cancelled', 'invoice.failed'] }\r\n   * );\r\n   * ```\r\n   */\r\n  async update(\r\n    companyId: ResourceId,\r\n    webhookId: ResourceId,\r\n    data: Partial<Webhook>\r\n  ): Promise<Webhook> {\r\n    const path = `/companies/${companyId}/webhooks/${webhookId}`;\r\n    const response = await this.http.put<Webhook>(path, data);\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Delete a webhook\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param webhookId - Webhook ID\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * await nfe.webhooks.delete('company-id', 'webhook-id');\r\n   * console.log('Webhook deleted');\r\n   * ```\r\n   */\r\n  async delete(\r\n    companyId: ResourceId,\r\n    webhookId: ResourceId\r\n  ): Promise<void> {\r\n    const path = `/companies/${companyId}/webhooks/${webhookId}`;\r\n    await this.http.delete(path);\r\n  }\r\n\r\n  /**\r\n   * Validate webhook signature\r\n   * \r\n   * Verifies that a webhook request came from NFE.io by validating its signature.\r\n   * This should be used to ensure webhook security.\r\n   * \r\n   * @param payload - Raw webhook payload (as string)\r\n   * @param signature - Signature from X-NFE-Signature header\r\n   * @param secret - Your webhook secret\r\n   * @returns True if signature is valid\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * // In your webhook endpoint:\r\n   * app.post('/webhook/nfe', async (req, res) => {\r\n   *   const signature = req.headers['x-nfe-signature'];\r\n   *   const payload = JSON.stringify(req.body);\r\n   *   \r\n   *   const isValid = nfe.webhooks.validateSignature(\r\n   *     payload,\r\n   *     signature,\r\n   *     'sua-chave-secreta'\r\n   *   );\r\n   *   \r\n   *   if (!isValid) {\r\n   *     return res.status(401).send('Invalid signature');\r\n   *   }\r\n   *   \r\n   *   // Process webhook...\r\n   * });\r\n   * ```\r\n   */\r\n  validateSignature(\r\n    payload: string,\r\n    signature: string,\r\n    secret: string\r\n  ): boolean {\r\n    try {\r\n      // Import crypto dynamically to avoid issues in non-Node environments\r\n      const crypto = (globalThis as any).require?.('crypto');\r\n      if (!crypto) {\r\n        throw new Error('crypto module not available');\r\n      }\r\n\r\n      const hmac = crypto.createHmac('sha256', secret);\r\n      hmac.update(payload);\r\n      const expectedSignature = hmac.digest('hex');\r\n\r\n      // Use timing-safe comparison to prevent timing attacks\r\n      return crypto.timingSafeEqual(\r\n        Buffer.from(signature),\r\n        Buffer.from(expectedSignature)\r\n      );\r\n    } catch (error) {\r\n      console.error('Error validating webhook signature:', error);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Test webhook delivery\r\n   * \r\n   * Sends a test event to the webhook URL to verify it's working\r\n   * \r\n   * @param companyId - Company ID\r\n   * @param webhookId - Webhook ID\r\n   * @returns Test result\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const result = await nfe.webhooks.test('company-id', 'webhook-id');\r\n   * if (result.success) {\r\n   *   console.log('Webhook is working!');\r\n   * }\r\n   * ```\r\n   */\r\n  async test(\r\n    companyId: ResourceId,\r\n    webhookId: ResourceId\r\n  ): Promise<{ success: boolean; message?: string }> {\r\n    const path = `/companies/${companyId}/webhooks/${webhookId}/test`;\r\n    const response = await this.http.post<{ success: boolean; message?: string }>(\r\n      path,\r\n      {}\r\n    );\r\n    \r\n    return response.data;\r\n  }\r\n\r\n  /**\r\n   * Get available webhook events\r\n   * \r\n   * Returns a list of all available webhook event types\r\n   * \r\n   * @returns List of available events\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const events = nfe.webhooks.getAvailableEvents();\r\n   * console.log('Available events:', events);\r\n   * ```\r\n   */\r\n  getAvailableEvents(): WebhookEvent[] {\r\n    return [\r\n      'invoice.issued',\r\n      'invoice.cancelled',\r\n      'invoice.failed',\r\n      'invoice.processing',\r\n      'company.created',\r\n      'company.updated',\r\n      'company.deleted',\r\n    ] as WebhookEvent[];\r\n  }\r\n}\r\n","/**\r\n * NFE.io SDK v3 - Resources Index\r\n * \r\n * Centralized exports for all API resources\r\n */\r\n\r\n// Resource classes\r\nexport { ServiceInvoicesResource, createServiceInvoicesResource } from './service-invoices.js';\r\nexport { CompaniesResource, createCompaniesResource } from './companies.js';\r\nexport { LegalPeopleResource } from './legal-people.js';\r\nexport { NaturalPeopleResource } from './natural-people.js';\r\nexport { WebhooksResource } from './webhooks.js';","/**\r\n * @fileoverview NFE.io SDK v3 - Main Client\r\n * \r\n * @description\r\n * Core client class for interacting with the NFE.io API v1.\r\n * Provides a modern TypeScript interface with zero runtime dependencies.\r\n * \r\n * @module @nfe-io/sdk/client\r\n * @author NFE.io\r\n * @license MIT\r\n */\r\n\r\nimport type { \r\n  NfeConfig, \r\n  RequiredNfeConfig, \r\n  ServiceInvoice, \r\n  PollOptions\r\n} from './types.js';\r\nimport { HttpClient, createDefaultRetryConfig, buildHttpConfig } from './http/client.js';\r\nimport { ErrorFactory, ConfigurationError, PollingTimeoutError } from './errors/index.js';\r\n\r\n// Resource imports\r\nimport { \r\n  ServiceInvoicesResource, \r\n  CompaniesResource,\r\n  LegalPeopleResource,\r\n  NaturalPeopleResource,\r\n  WebhooksResource\r\n} from './resources/index.js';\r\n\r\n// ============================================================================\r\n// Main NFE.io Client\r\n// ============================================================================\r\n\r\n/**\r\n * Main NFE.io API Client\r\n * \r\n * @description\r\n * Primary client class for interacting with the NFE.io API. Provides access to all\r\n * API resources including service invoices, companies, legal/natural people, and webhooks.\r\n * \r\n * **Features:**\r\n * - Zero runtime dependencies (uses native fetch)\r\n * - Automatic retry with exponential backoff\r\n * - TypeScript type safety\r\n * - Async invoice processing with polling utilities\r\n * - Environment detection and validation\r\n * \r\n * @example Basic Usage\r\n * ```typescript\r\n * import { NfeClient } from '@nfe-io/sdk';\r\n * \r\n * const nfe = new NfeClient({\r\n *   apiKey: 'your-api-key',\r\n *   environment: 'production' // or 'sandbox'\r\n * });\r\n * \r\n * // Create a company\r\n * const company = await nfe.companies.create({\r\n *   federalTaxNumber: '12345678000190',\r\n *   name: 'My Company'\r\n * });\r\n * \r\n * // Issue a service invoice\r\n * const invoice = await nfe.serviceInvoices.create(company.id, {\r\n *   borrower: { /* ... *\\/ },\r\n *   cityServiceCode: '12345',\r\n *   servicesAmount: 1000.00\r\n * });\r\n * ```\r\n * \r\n * @example With Custom Configuration\r\n * ```typescript\r\n * const nfe = new NfeClient({\r\n *   apiKey: process.env.NFE_API_KEY,\r\n *   environment: 'production',\r\n *   timeout: 60000, // 60 seconds\r\n *   retryConfig: {\r\n *     maxRetries: 5,\r\n *     baseDelay: 1000,\r\n *     maxDelay: 30000\r\n *   }\r\n * });\r\n * ```\r\n * \r\n * @example Async Invoice Processing\r\n * ```typescript\r\n * // Method 1: Manual polling\r\n * const result = await nfe.serviceInvoices.create(companyId, data);\r\n * if (result.status === 'pending') {\r\n *   const invoice = await nfe.pollUntilComplete(\r\n *     () => nfe.serviceInvoices.retrieve(companyId, result.id)\r\n *   );\r\n * }\r\n * \r\n * // Method 2: Automatic polling (recommended)\r\n * const invoice = await nfe.serviceInvoices.createAndWait(companyId, data, {\r\n *   maxAttempts: 30,\r\n *   interval: 2000 // Check every 2 seconds\r\n * });\r\n * ```\r\n * \r\n * @see {@link NfeConfig} for configuration options\r\n * @see {@link ServiceInvoicesResource} for invoice operations\r\n * @see {@link CompaniesResource} for company operations\r\n */\r\nexport class NfeClient {\r\n  /** @internal HTTP client for making API requests */\r\n  private readonly http: HttpClient;\r\n  \r\n  /** @internal Normalized client configuration */\r\n  private readonly config: RequiredNfeConfig;\r\n\r\n  /**\r\n   * Service Invoices API resource\r\n   * \r\n   * @description\r\n   * Provides operations for managing service invoices (NFS-e):\r\n   * - Create, list, retrieve, cancel service invoices\r\n   * - Send invoices by email\r\n   * - Download PDF and XML files\r\n   * - Automatic polling for async invoice processing\r\n   * \r\n   * @see {@link ServiceInvoicesResource}\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const invoice = await nfe.serviceInvoices.create(companyId, {\r\n   *   borrower: { name: 'Client', email: 'client@example.com' },\r\n   *   cityServiceCode: '12345',\r\n   *   servicesAmount: 1000.00\r\n   * });\r\n   * ```\r\n   */\r\n  public readonly serviceInvoices: ServiceInvoicesResource;\r\n\r\n  /**\r\n   * Companies API resource\r\n   * \r\n   * @description\r\n   * Provides operations for managing companies:\r\n   * - CRUD operations for companies\r\n   * - Upload digital certificates (PFX/P12)\r\n   * - Batch operations\r\n   * \r\n   * @see {@link CompaniesResource}\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const company = await nfe.companies.create({\r\n   *   federalTaxNumber: '12345678000190',\r\n   *   name: 'My Company',\r\n   *   email: 'company@example.com'\r\n   * });\r\n   * ```\r\n   */\r\n  public readonly companies: CompaniesResource;\r\n\r\n  /**\r\n   * Legal People API resource\r\n   * \r\n   * @description\r\n   * Provides operations for managing legal persons (empresas/PJ):\r\n   * - CRUD operations scoped by company\r\n   * - CNPJ lookup and validation\r\n   * - Batch operations\r\n   * \r\n   * @see {@link LegalPeopleResource}\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const legalPerson = await nfe.legalPeople.create(companyId, {\r\n   *   federalTaxNumber: '12345678000190',\r\n   *   name: 'Legal Person Company'\r\n   * });\r\n   * ```\r\n   */\r\n  public readonly legalPeople: LegalPeopleResource;\r\n\r\n  /**\r\n   * Natural People API resource\r\n   * \r\n   * @description\r\n   * Provides operations for managing natural persons (pessoas fsicas/PF):\r\n   * - CRUD operations scoped by company\r\n   * - CPF lookup and validation\r\n   * - Batch operations\r\n   * \r\n   * @see {@link NaturalPeopleResource}\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const naturalPerson = await nfe.naturalPeople.create(companyId, {\r\n   *   federalTaxNumber: '12345678901',\r\n   *   name: 'John Doe'\r\n   * });\r\n   * ```\r\n   */\r\n  public readonly naturalPeople: NaturalPeopleResource;\r\n\r\n  /**\r\n   * Webhooks API resource\r\n   * \r\n   * @description\r\n   * Provides operations for managing webhooks:\r\n   * - CRUD operations for webhook configurations\r\n   * - Webhook signature validation\r\n   * - Test webhook delivery\r\n   * - List available event types\r\n   * \r\n   * @see {@link WebhooksResource}\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const webhook = await nfe.webhooks.create({\r\n   *   url: 'https://example.com/webhook',\r\n   *   events: ['invoice.issued', 'invoice.cancelled']\r\n   * });\r\n   * ```\r\n   */\r\n  public readonly webhooks: WebhooksResource;\r\n\r\n  /**\r\n   * Create a new NFE.io API client\r\n   * \r\n   * @param config - Client configuration options\r\n   * @throws {ConfigurationError} If configuration is invalid\r\n   * @throws {ConfigurationError} If Node.js version < 18\r\n   * @throws {ConfigurationError} If fetch API is not available\r\n   * \r\n   * @example Basic\r\n   * ```typescript\r\n   * const nfe = new NfeClient({\r\n   *   apiKey: 'your-api-key',\r\n   *   environment: 'production'\r\n   * });\r\n   * ```\r\n   * \r\n   * @example With environment variable\r\n   * ```typescript\r\n   * // Set NFE_API_KEY environment variable\r\n   * const nfe = new NfeClient({\r\n   *   environment: 'production'\r\n   * });\r\n   * ```\r\n   * \r\n   * @example With custom retry config\r\n   * ```typescript\r\n   * const nfe = new NfeClient({\r\n   *   apiKey: 'your-api-key',\r\n   *   timeout: 60000,\r\n   *   retryConfig: {\r\n   *     maxRetries: 5,\r\n   *     baseDelay: 1000,\r\n   *     maxDelay: 30000\r\n   *   }\r\n   * });\r\n   * ```\r\n   */\r\n  constructor(config: NfeConfig) {\r\n    // Validate and normalize configuration\r\n    this.config = this.validateAndNormalizeConfig(config);\r\n    \r\n    // Validate Node.js environment\r\n    this.validateEnvironment();\r\n    \r\n    // Create HTTP client\r\n    const httpConfig = buildHttpConfig(\r\n      this.config.apiKey,\r\n      this.getBaseUrl(),\r\n      this.config.timeout,\r\n      this.config.retryConfig\r\n    );\r\n    this.http = new HttpClient(httpConfig);\r\n\r\n    // Initialize resources\r\n    this.serviceInvoices = new ServiceInvoicesResource(this.http);\r\n    this.companies = new CompaniesResource(this.http);\r\n    this.legalPeople = new LegalPeopleResource(this.http);\r\n    this.naturalPeople = new NaturalPeopleResource(this.http);\r\n    this.webhooks = new WebhooksResource(this.http);\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Configuration Management\r\n  // --------------------------------------------------------------------------\r\n\r\n  private validateAndNormalizeConfig(config: NfeConfig): RequiredNfeConfig {\r\n    if (!config.apiKey) {\r\n      // Try to get from environment variable\r\n      const envApiKey = this.getEnvironmentVariable('NFE_API_KEY');\r\n      if (!envApiKey) {\r\n        throw ErrorFactory.fromMissingApiKey();\r\n      }\r\n      config.apiKey = envApiKey;\r\n    }\r\n\r\n    // Normalize environment\r\n    const environment = config.environment || 'production';\r\n    if (!['production', 'sandbox'].includes(environment)) {\r\n      throw new ConfigurationError(\r\n        `Invalid environment: ${environment}. Must be 'production' or 'sandbox'.`,\r\n        { environment }\r\n      );\r\n    }\r\n\r\n    // Set defaults\r\n    const normalizedConfig: RequiredNfeConfig = {\r\n      apiKey: config.apiKey,\r\n      environment,\r\n      baseUrl: config.baseUrl || this.getDefaultBaseUrl(environment),\r\n      timeout: config.timeout || 30000,\r\n      retryConfig: config.retryConfig || createDefaultRetryConfig(),\r\n    };\r\n\r\n    return normalizedConfig;\r\n  }\r\n\r\n  private getDefaultBaseUrl(environment: 'production' | 'sandbox'): string {\r\n    const baseUrls = {\r\n      production: 'https://api.nfe.io/v1',\r\n      sandbox: 'https://api-sandbox.nfe.io/v1', // Adjust if sandbox exists\r\n    };\r\n    return baseUrls[environment];\r\n  }\r\n\r\n  private getBaseUrl(): string {\r\n    return this.config.baseUrl;\r\n  }\r\n\r\n  private getEnvironmentVariable(name: string): string | undefined {\r\n    // Safe access to process.env with fallback\r\n    try {\r\n      return (globalThis as any).process?.env?.[name];\r\n    } catch {\r\n      return undefined;\r\n    }\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Environment Validation\r\n  // --------------------------------------------------------------------------\r\n\r\n  private validateEnvironment(): void {\r\n    // Check Node.js version (should support fetch natively)\r\n    this.validateNodeVersion();\r\n    \r\n    // Check fetch availability\r\n    if (typeof fetch === 'undefined') {\r\n      throw ErrorFactory.fromNodeVersionError(this.getNodeVersion());\r\n    }\r\n  }\r\n\r\n  private validateNodeVersion(): void {\r\n    const nodeVersion = this.getNodeVersion();\r\n    const majorVersion = this.extractMajorVersion(nodeVersion);\r\n    \r\n    if (majorVersion < 18) {\r\n      throw ErrorFactory.fromNodeVersionError(nodeVersion);\r\n    }\r\n  }\r\n\r\n  private getNodeVersion(): string {\r\n    try {\r\n      return (globalThis as any).process?.version || 'unknown';\r\n    } catch {\r\n      return 'unknown';\r\n    }\r\n  }\r\n\r\n  private extractMajorVersion(version: string): number {\r\n    const match = version.match(/^v?(\\d+)\\./);\r\n    return match ? parseInt(match[1]!, 10) : 0;\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Public Utility Methods\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Update client configuration dynamically\r\n   * \r\n   * @param newConfig - Partial configuration to merge with existing config\r\n   * @throws {ConfigurationError} If new configuration is invalid\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const nfe = new NfeClient({ apiKey: 'old-key' });\r\n   * \r\n   * // Switch to sandbox environment\r\n   * nfe.updateConfig({ environment: 'sandbox' });\r\n   * \r\n   * // Update timeout\r\n   * nfe.updateConfig({ timeout: 60000 });\r\n   * ```\r\n   */\r\n  public updateConfig(newConfig: Partial<NfeConfig>): void {\r\n    const mergedConfig = { ...this.config, ...newConfig };\r\n    const normalizedConfig = this.validateAndNormalizeConfig(mergedConfig);\r\n    \r\n    // Update internal config\r\n    Object.assign(this.config, normalizedConfig);\r\n    \r\n    // Recreate HTTP client with new config\r\n    const httpConfig = buildHttpConfig(\r\n      this.config.apiKey,\r\n      this.getBaseUrl(),\r\n      this.config.timeout,\r\n      this.config.retryConfig\r\n    );\r\n    Object.assign(this.http, new HttpClient(httpConfig));\r\n  }\r\n\r\n  /**\r\n   * Set request timeout in milliseconds\r\n   * \r\n   * @param timeout - Request timeout in milliseconds\r\n   * \r\n   * @description\r\n   * Maintains v2 API compatibility. Equivalent to `updateConfig({ timeout })`.\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * nfe.setTimeout(60000); // 60 seconds\r\n   * ```\r\n   */\r\n  public setTimeout(timeout: number): void {\r\n    this.updateConfig({ timeout });\r\n  }\r\n\r\n  /**\r\n   * Set or update API key\r\n   * \r\n   * @param apiKey - New API key to use for authentication\r\n   * \r\n   * @description\r\n   * Maintains v2 API compatibility. Equivalent to `updateConfig({ apiKey })`.\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * nfe.setApiKey('new-api-key');\r\n   * ```\r\n   */\r\n  public setApiKey(apiKey: string): void {\r\n    this.updateConfig({ apiKey });\r\n  }\r\n\r\n  /**\r\n   * Get current client configuration\r\n   * \r\n   * @returns Readonly copy of current configuration\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const config = nfe.getConfig();\r\n   * console.log('Environment:', config.environment);\r\n   * console.log('Base URL:', config.baseUrl);\r\n   * console.log('Timeout:', config.timeout);\r\n   * ```\r\n   */\r\n  public getConfig(): Readonly<RequiredNfeConfig> {\r\n    return { ...this.config };\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Polling Utility (for async invoice processing)\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Poll a resource until it completes or times out\r\n   * \r\n   * @template T - Type of the resource being polled\r\n   * @param locationUrl - URL or path to poll\r\n   * @param options - Polling configuration\r\n   * @returns Promise that resolves when resource is complete\r\n   * @throws {PollingTimeoutError} If polling exceeds maxAttempts\r\n   * \r\n   * @description\r\n   * Critical utility for NFE.io's async invoice processing. When creating a service\r\n   * invoice, the API returns a 202 response with a location URL. This method polls\r\n   * that URL until the invoice is fully processed or the polling times out.\r\n   * \r\n   * @example Basic usage\r\n   * ```typescript\r\n   * const result = await nfe.serviceInvoices.create(companyId, data);\r\n   * \r\n   * if (result.status === 'pending') {\r\n   *   const invoice = await nfe.pollUntilComplete(result.location);\r\n   *   console.log('Invoice issued:', invoice.number);\r\n   * }\r\n   * ```\r\n   * \r\n   * @example With custom polling options\r\n   * ```typescript\r\n   * const invoice = await nfe.pollUntilComplete(locationUrl, {\r\n   *   maxAttempts: 60,  // Poll up to 60 times\r\n   *   intervalMs: 3000  // Wait 3 seconds between attempts\r\n   * });\r\n   * ```\r\n   * \r\n   * @example Using createAndWait (recommended)\r\n   * ```typescript\r\n   * // Instead of manual polling, use the convenience method:\r\n   * const invoice = await nfe.serviceInvoices.createAndWait(companyId, data, {\r\n   *   maxAttempts: 30,\r\n   *   interval: 2000\r\n   * });\r\n   * ```\r\n   * \r\n   * @see {@link PollOptions} for configuration options\r\n   * @see {@link ServiceInvoicesResource.createAndWait} for automated polling\r\n   */\r\n  public async pollUntilComplete<T = ServiceInvoice>(\r\n    locationUrl: string, \r\n    options: PollOptions = {}\r\n  ): Promise<T> {\r\n    const { \r\n      maxAttempts = 30,\r\n      intervalMs = 2000 \r\n    } = options;\r\n    \r\n    for (let attempt = 0; attempt < maxAttempts; attempt++) {\r\n      // Wait before polling (except first attempt)\r\n      if (attempt > 0) {\r\n        await this.sleep(intervalMs);\r\n      }\r\n      \r\n      try {\r\n        // Extract path from full URL for HTTP client\r\n        const path = this.extractPathFromUrl(locationUrl);\r\n        const response = await this.http.get<any>(path);\r\n        \r\n        // Check completion status\r\n        if (this.isCompleteResponse(response.data)) {\r\n          return response.data as T;\r\n        }\r\n        \r\n        if (this.isFailedResponse(response.data)) {\r\n          throw new PollingTimeoutError(\r\n            `Resource processing failed: ${response.data.error || 'Unknown error'}`,\r\n            response.data\r\n          );\r\n        }\r\n        \r\n        // Continue polling if still in progress\r\n        \r\n      } catch (error) {\r\n        // If it's the last attempt, throw the error\r\n        if (attempt === maxAttempts - 1) {\r\n          throw error;\r\n        }\r\n        \r\n        // For other attempts, continue polling (might be temporary network issue)\r\n      }\r\n    }\r\n    \r\n    throw new PollingTimeoutError(\r\n      `Polling timeout after ${maxAttempts} attempts. Resource may still be processing.`,\r\n      { maxAttempts, intervalMs }\r\n    );\r\n  }\r\n\r\n  private extractPathFromUrl(url: string): string {\r\n    try {\r\n      const urlObj = new URL(url);\r\n      return urlObj.pathname + urlObj.search;\r\n    } catch {\r\n      // If URL parsing fails, assume it's already a path\r\n      return url.startsWith('/') ? url : `/${url}`;\r\n    }\r\n  }\r\n\r\n  private isCompleteResponse(data: any): boolean {\r\n    return data && (\r\n      data.status === 'completed' || \r\n      data.status === 'issued' ||\r\n      (data.id && data.number && !data.status) // NFE.io completed invoices might not have explicit status\r\n    );\r\n  }\r\n\r\n  private isFailedResponse(data: any): boolean {\r\n    return data && (\r\n      data.status === 'failed' || \r\n      data.status === 'error' ||\r\n      data.error\r\n    );\r\n  }\r\n\r\n  private sleep(ms: number): Promise<void> {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n  }\r\n\r\n  // --------------------------------------------------------------------------\r\n  // Health Check & Debug\r\n  // --------------------------------------------------------------------------\r\n\r\n  /**\r\n   * Check if the client is properly configured and can reach the NFE.io API\r\n   * \r\n   * @returns Health check result with status and optional error details\r\n   * \r\n   * @description\r\n   * Performs a simple API request to verify connectivity and authentication.\r\n   * Useful for debugging connection issues or validating client configuration.\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const health = await nfe.healthCheck();\r\n   * \r\n   * if (health.status === 'ok') {\r\n   *   console.log('API connection successful!');\r\n   * } else {\r\n   *   console.error('API connection failed:', health.details);\r\n   * }\r\n   * ```\r\n   * \r\n   * @example In application startup\r\n   * ```typescript\r\n   * async function initializeApp() {\r\n   *   const nfe = new NfeClient({ apiKey: process.env.NFE_API_KEY });\r\n   *   \r\n   *   const health = await nfe.healthCheck();\r\n   *   if (health.status !== 'ok') {\r\n   *     throw new Error(`NFE.io API is not reachable: ${health.details?.error}`);\r\n   *   }\r\n   *   \r\n   *   console.log('NFE.io SDK initialized successfully');\r\n   * }\r\n   * ```\r\n   */\r\n  public async healthCheck(): Promise<{ status: 'ok' | 'error', details?: any }> {\r\n    try {\r\n      // Try to make a simple request (get companies list with pageCount=1)\r\n      await this.http.get('/companies', { pageCount: 1 });\r\n      return { status: 'ok' };\r\n    } catch (error) {\r\n      return { \r\n        status: 'error', \r\n        details: {\r\n          error: error instanceof Error ? error.message : 'Unknown error',\r\n          config: {\r\n            baseUrl: this.config.baseUrl,\r\n            environment: this.config.environment,\r\n            hasApiKey: !!this.config.apiKey,\r\n          }\r\n        }\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get client information for debugging and diagnostics\r\n   * \r\n   * @returns Client diagnostic information\r\n   * \r\n   * @description\r\n   * Returns comprehensive information about the current SDK instance,\r\n   * useful for bug reports and troubleshooting.\r\n   * \r\n   * @example\r\n   * ```typescript\r\n   * const info = nfe.getClientInfo();\r\n   * console.log('SDK Version:', info.version);\r\n   * console.log('Node Version:', info.nodeVersion);\r\n   * console.log('Environment:', info.environment);\r\n   * console.log('Base URL:', info.baseUrl);\r\n   * ```\r\n   * \r\n   * @example In error reporting\r\n   * ```typescript\r\n   * try {\r\n   *   await nfe.serviceInvoices.create(companyId, data);\r\n   * } catch (error) {\r\n   *   const info = nfe.getClientInfo();\r\n   *   console.error('Error context:', {\r\n   *     error: error.message,\r\n   *     sdkInfo: info\r\n   *   });\r\n   * }\r\n   * ```\r\n   */\r\n  public getClientInfo(): {\r\n    version: string;\r\n    nodeVersion: string;\r\n    environment: string;\r\n    baseUrl: string;\r\n    hasApiKey: boolean;\r\n  } {\r\n    return {\r\n      version: '3.0.0-beta.1', // TODO: Read from package.json\r\n      nodeVersion: this.getNodeVersion(),\r\n      environment: this.config.environment,\r\n      baseUrl: this.config.baseUrl,\r\n      hasApiKey: !!this.config.apiKey,\r\n    };\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Factory Functions (maintain v2 compatibility)\r\n// ============================================================================\r\n\r\n/**\r\n * Create NFE.io client instance using factory function\r\n * \r\n * @param apiKey - API key string or full configuration object\r\n * @param _version - API version (ignored in v3, maintained for v2 compatibility)\r\n * @returns Configured NfeClient instance\r\n * \r\n * @description\r\n * Factory function for creating NFE.io client instances. Maintains v2 API compatibility\r\n * while providing modern TypeScript support.\r\n * \r\n * @example String API key\r\n * ```typescript\r\n * const nfe = createNfeClient('your-api-key');\r\n * ```\r\n * \r\n * @example Configuration object\r\n * ```typescript\r\n * const nfe = createNfeClient({\r\n *   apiKey: 'your-api-key',\r\n *   environment: 'sandbox',\r\n *   timeout: 60000\r\n * });\r\n * ```\r\n * \r\n * @example v2 compatibility\r\n * ```typescript\r\n * // v2 style (still works)\r\n * const nfe = createNfeClient('your-api-key');\r\n * ```\r\n */\r\nexport function createNfeClient(apiKey: string | NfeConfig): NfeClient {\r\n  const config = typeof apiKey === 'string' ? { apiKey } : apiKey;\r\n  return new NfeClient(config);\r\n}\r\n\r\n/**\r\n * Default export factory function for CommonJS compatibility\r\n * \r\n * @param apiKey - API key string or full configuration object\r\n * @returns Configured NfeClient instance\r\n * \r\n * @description\r\n * Default export maintains v2 API compatibility for CommonJS users.\r\n * Equivalent to `createNfeClient()`.\r\n * \r\n * @example ES Modules\r\n * ```typescript\r\n * import nfe from '@nfe-io/sdk';\r\n * const client = nfe('your-api-key');\r\n * ```\r\n * \r\n * @example CommonJS\r\n * ```javascript\r\n * const nfe = require('@nfe-io/sdk').default;\r\n * const client = nfe('your-api-key');\r\n * ```\r\n */\r\nexport default function nfe(apiKey: string | NfeConfig): NfeClient {\r\n  return createNfeClient(apiKey);\r\n}\r\n\r\n// ============================================================================\r\n// Version Constants\r\n// ============================================================================\r\n\r\n/**\r\n * Current SDK version\r\n * @constant\r\n */\r\nexport const VERSION = '3.0.0-beta.1';\r\n\r\n/**\r\n * Supported Node.js version range (semver format)\r\n * @constant\r\n */\r\nexport const SUPPORTED_NODE_VERSIONS = '>=18.0.0';\r\n\r\n/**\r\n * Default request timeout in milliseconds\r\n * @constant\r\n */\r\nexport const DEFAULT_TIMEOUT = 30000;\r\n\r\n/**\r\n * Default number of retry attempts for failed requests\r\n * @constant\r\n */\r\nexport const DEFAULT_RETRY_ATTEMPTS = 3;","/**\r\n * @fileoverview NFE.io SDK v3 - Official Node.js SDK for NFE.io API\r\n * \r\n * @description\r\n * Modern TypeScript SDK for NFE.io API with zero runtime dependencies.\r\n * Compatible with Node.js 18+ and modern JavaScript runtimes.\r\n * \r\n * @example Basic Usage\r\n * ```typescript\r\n * import { NfeClient } from '@nfe-io/sdk';\r\n * \r\n * const nfe = new NfeClient({ \r\n *   apiKey: 'your-api-key',\r\n *   environment: 'production' // or 'sandbox'\r\n * });\r\n * \r\n * // Create a service invoice\r\n * const invoice = await nfe.serviceInvoices.create('company-id', {\r\n *   borrower: { /* ... *\\/ },\r\n *   cityServiceCode: '12345',\r\n *   servicesAmount: 1000.00\r\n * });\r\n * ```\r\n * \r\n * @example With Polling\r\n * ```typescript\r\n * // Automatically poll until invoice is processed\r\n * const invoice = await nfe.serviceInvoices.createAndWait('company-id', data, {\r\n *   maxAttempts: 30,\r\n *   interval: 2000\r\n * });\r\n * ```\r\n * \r\n * @module @nfe-io/sdk\r\n * @version 3.0.0-beta.1\r\n * @author NFE.io\r\n * @license MIT\r\n */\r\n\r\n// ============================================================================\r\n// Main Exports\r\n// ============================================================================\r\n\r\n/**\r\n * Core client exports\r\n * \r\n * @see {@link NfeClient} - Main client class for NFE.io API\r\n * @see {@link createNfeClient} - Factory function for creating client instances\r\n */\r\nexport { NfeClient, createNfeClient, VERSION, SUPPORTED_NODE_VERSIONS } from './core/client.js';\r\n\r\n/**\r\n * TypeScript type definitions for NFE.io API entities and configurations\r\n * \r\n * @see {@link NfeConfig} - Client configuration options\r\n * @see {@link Company} - Company entity type\r\n * @see {@link ServiceInvoice} - Service invoice entity type\r\n * @see {@link LegalPerson} - Legal person (empresa) entity type\r\n * @see {@link NaturalPerson} - Natural person (pessoa fsica) entity type\r\n * @see {@link Webhook} - Webhook configuration type\r\n */\r\nexport type {\r\n  // Configuration\r\n  NfeConfig,\r\n  RequiredNfeConfig,\r\n  RetryConfig,\r\n  \r\n  // Entities\r\n  Company,\r\n  LegalPerson,\r\n  NaturalPerson,\r\n  ServiceInvoice,\r\n  ServiceInvoiceData,\r\n  ServiceInvoiceBorrower,\r\n  ServiceInvoiceDetails,\r\n  ServiceInvoiceStatus,\r\n  Webhook,\r\n  WebhookEvent,\r\n  \r\n  // Common types\r\n  Address,\r\n  City,\r\n  EntityType,\r\n  TaxRegime,\r\n  SpecialTaxRegime,\r\n  \r\n  // HTTP and pagination\r\n  HttpResponse,\r\n  ListResponse,\r\n  PageInfo,\r\n  PaginationOptions,\r\n  PollOptions,\r\n  \r\n  // Utility types\r\n  ResourceId,\r\n  ApiErrorResponse,\r\n} from './core/types.js';\r\n\r\n/**\r\n * Error classes and utilities for comprehensive error handling\r\n * \r\n * @see {@link NfeError} - Base error class for all SDK errors\r\n * @see {@link AuthenticationError} - Thrown when API key is invalid (401)\r\n * @see {@link ValidationError} - Thrown when request validation fails (400, 422)\r\n * @see {@link NotFoundError} - Thrown when resource not found (404)\r\n * @see {@link RateLimitError} - Thrown when rate limit exceeded (429)\r\n * @see {@link ServerError} - Thrown on server errors (500, 502, 503)\r\n * @see {@link ConnectionError} - Thrown on network/connection failures\r\n * @see {@link TimeoutError} - Thrown when request times out\r\n * @see {@link PollingTimeoutError} - Thrown when invoice polling times out\r\n */\r\nexport {\r\n  // Base error\r\n  NfeError,\r\n  \r\n  // HTTP errors\r\n  AuthenticationError,\r\n  ValidationError,\r\n  NotFoundError,\r\n  ConflictError,\r\n  RateLimitError,\r\n  ServerError,\r\n  \r\n  // Connection errors\r\n  ConnectionError,\r\n  TimeoutError,\r\n  \r\n  // SDK errors\r\n  ConfigurationError,\r\n  PollingTimeoutError,\r\n  InvoiceProcessingError,\r\n  \r\n  // Error factory\r\n  ErrorFactory,\r\n  \r\n  // Type guards\r\n  isNfeError,\r\n  isAuthenticationError,\r\n  isValidationError,\r\n  isNotFoundError,\r\n  isConnectionError,\r\n  isTimeoutError,\r\n  isPollingTimeoutError,\r\n  \r\n  // Legacy aliases (v2 compatibility)\r\n  BadRequestError,\r\n  APIError,\r\n  InternalServerError,\r\n  \r\n  // Error types\r\n  ErrorTypes,\r\n  type ErrorType,\r\n} from './core/errors/index.js';\r\n\r\n// ============================================================================\r\n// Default Export (maintains v2 compatibility)\r\n// ============================================================================\r\n\r\n/**\r\n * Default export for CommonJS compatibility\r\n * \r\n * @description\r\n * Allows both ES modules and CommonJS usage:\r\n * \r\n * @example ES Modules\r\n * ```typescript\r\n * import { NfeClient } from '@nfe-io/sdk';\r\n * const nfe = new NfeClient({ apiKey: 'xxx' });\r\n * ```\r\n * \r\n * @example ES Modules (default import)\r\n * ```typescript\r\n * import nfeFactory from '@nfe-io/sdk';\r\n * const nfe = nfeFactory({ apiKey: 'xxx' });\r\n * ```\r\n * \r\n * @example CommonJS\r\n * ```javascript\r\n * const { NfeClient } = require('@nfe-io/sdk');\r\n * const nfe = new NfeClient({ apiKey: 'xxx' });\r\n * ```\r\n * \r\n * @example CommonJS (default require)\r\n * ```javascript\r\n * const nfeFactory = require('@nfe-io/sdk').default;\r\n * const nfe = nfeFactory({ apiKey: 'xxx' });\r\n * ```\r\n */\r\nimport nfeFactory from './core/client.js';\r\nexport default nfeFactory;\r\n\r\n// ============================================================================\r\n// Package Information\r\n// ============================================================================\r\n\r\n/**\r\n * NPM package name\r\n * @constant\r\n */\r\nexport const PACKAGE_NAME = '@nfe-io/sdk';\r\n\r\n/**\r\n * Current SDK version\r\n * @constant\r\n */\r\nexport const PACKAGE_VERSION = '3.0.0-beta.1';\r\n\r\n/**\r\n * NFE.io API version supported by this SDK\r\n * @constant\r\n */\r\nexport const API_VERSION = 'v1';\r\n\r\n/**\r\n * GitHub repository URL\r\n * @constant\r\n */\r\nexport const REPOSITORY_URL = 'https://github.com/nfe/client-nodejs';\r\n\r\n/**\r\n * Official NFE.io API documentation URL\r\n * @constant\r\n */\r\nexport const DOCUMENTATION_URL = 'https://nfe.io/docs';\r\n\r\n// ============================================================================\r\n// Environment Detection & Utilities\r\n// ============================================================================\r\n\r\n/**\r\n * Check if the current environment supports NFE.io SDK v3 requirements\r\n * \r\n * @description\r\n * Validates that the runtime environment has all necessary features:\r\n * - Node.js 18+ (for native fetch support)\r\n * - Fetch API availability\r\n * - AbortController availability\r\n * \r\n * @returns Object containing support status and detected issues\r\n * \r\n * @example\r\n * ```typescript\r\n * const check = isEnvironmentSupported();\r\n * if (!check.supported) {\r\n *   console.error('Environment issues:', check.issues);\r\n *   console.error('Node version:', check.nodeVersion);\r\n * }\r\n * ```\r\n */\r\nexport function isEnvironmentSupported(): {\r\n  /** Whether all requirements are met */\r\n  supported: boolean;\r\n  /** Detected Node.js version (e.g., \"v18.17.0\") */\r\n  nodeVersion?: string;\r\n  /** Whether Fetch API is available */\r\n  hasFetch: boolean;\r\n  /** Whether AbortController is available */\r\n  hasAbortController: boolean;\r\n  /** List of detected compatibility issues */\r\n  issues: string[];\r\n} {\r\n  const issues: string[] = [];\r\n  let nodeVersion: string | undefined;\r\n  \r\n  // Check Node.js version\r\n  try {\r\n    nodeVersion = (globalThis as any).process?.version;\r\n    if (nodeVersion) {\r\n      const majorVersion = parseInt(nodeVersion.slice(1).split('.')[0]!);\r\n      if (majorVersion < 18) {\r\n        issues.push(`Node.js ${majorVersion} is not supported. Requires Node.js 18+.`);\r\n      }\r\n    }\r\n  } catch {\r\n    issues.push('Unable to detect Node.js version');\r\n  }\r\n  \r\n  // Check fetch support\r\n  const hasFetch = typeof fetch !== 'undefined';\r\n  if (!hasFetch) {\r\n    issues.push('Fetch API not available');\r\n  }\r\n  \r\n  // Check AbortController support\r\n  const hasAbortController = typeof AbortController !== 'undefined';\r\n  if (!hasAbortController) {\r\n    issues.push('AbortController not available');\r\n  }\r\n  \r\n  const result: {\r\n    supported: boolean;\r\n    nodeVersion?: string;\r\n    hasFetch: boolean;\r\n    hasAbortController: boolean;\r\n    issues: string[];\r\n  } = {\r\n    supported: issues.length === 0,\r\n    hasFetch,\r\n    hasAbortController,\r\n    issues,\r\n  };\r\n  \r\n  if (nodeVersion) {\r\n    result.nodeVersion = nodeVersion;\r\n  }\r\n  \r\n  return result;\r\n}\r\n\r\n/**\r\n * Get comprehensive SDK runtime information\r\n * \r\n * @description\r\n * Returns detailed information about the current runtime environment,\r\n * useful for debugging and support.\r\n * \r\n * @returns Object containing SDK and runtime environment information\r\n * \r\n * @example\r\n * ```typescript\r\n * const info = getRuntimeInfo();\r\n * console.log('SDK Version:', info.sdkVersion);\r\n * console.log('Node Version:', info.nodeVersion);\r\n * console.log('Platform:', info.platform);\r\n * console.log('Environment:', info.environment);\r\n * ```\r\n */\r\nexport function getRuntimeInfo(): {\r\n  /** Current SDK version */\r\n  sdkVersion: string;\r\n  /** Node.js version (e.g., \"v18.17.0\") */\r\n  nodeVersion: string;\r\n  /** Operating system platform (e.g., \"linux\", \"darwin\", \"win32\") */\r\n  platform: string;\r\n  /** CPU architecture (e.g., \"x64\", \"arm64\") */\r\n  arch: string;\r\n  /** Runtime environment type */\r\n  environment: 'node' | 'browser' | 'unknown';\r\n} {\r\n  let nodeVersion = 'unknown';\r\n  let platform = 'unknown';\r\n  let arch = 'unknown';\r\n  let environment: 'node' | 'browser' | 'unknown' = 'unknown';\r\n  \r\n  try {\r\n    const process = (globalThis as any).process;\r\n    if (process) {\r\n      nodeVersion = process.version || 'unknown';\r\n      platform = process.platform || 'unknown';\r\n      arch = process.arch || 'unknown';\r\n      environment = 'node';\r\n    } else if (typeof window !== 'undefined' && typeof (window as any).navigator !== 'undefined') {\r\n      environment = 'browser';\r\n      platform = (window as any).navigator.platform || 'unknown';\r\n    }\r\n  } catch {\r\n    // Safe fallback\r\n  }\r\n  \r\n  return {\r\n    sdkVersion: PACKAGE_VERSION,\r\n    nodeVersion,\r\n    platform,\r\n    arch,\r\n    environment,\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// Quick Start Helpers\r\n// ============================================================================\r\n\r\n/**\r\n * Create NFE.io client from environment variable\r\n * \r\n * @description\r\n * Convenience function that reads API key from NFE_API_KEY environment variable.\r\n * Useful for serverless functions and quick prototyping.\r\n * \r\n * @param environment - Target environment ('production' or 'sandbox')\r\n * @returns Configured NfeClient instance\r\n * @throws {ConfigurationError} If NFE_API_KEY environment variable is not set\r\n * \r\n * @example\r\n * ```typescript\r\n * // Set environment variable: NFE_API_KEY=your-api-key\r\n * const nfe = createClientFromEnv('production');\r\n * \r\n * // Use the client normally\r\n * const companies = await nfe.companies.list();\r\n * ```\r\n * \r\n * @example Docker/Kubernetes\r\n * ```yaml\r\n * env:\r\n *   - name: NFE_API_KEY\r\n *     valueFrom:\r\n *       secretKeyRef:\r\n *         name: nfe-credentials\r\n *         key: api-key\r\n * ```\r\n */\r\nexport function createClientFromEnv(environment?: 'production' | 'sandbox') {\r\n  const apiKey = (globalThis as any).process?.env?.NFE_API_KEY;\r\n  if (!apiKey) {\r\n    const { ConfigurationError } = require('./core/errors');\r\n    throw new ConfigurationError(\r\n      'NFE_API_KEY environment variable is required when using createClientFromEnv()'\r\n    );\r\n  }\r\n  \r\n  const { NfeClient } = require('./core/client');\r\n  return new NfeClient({ \r\n    apiKey, \r\n    environment: environment || 'production' \r\n  });\r\n}\r\n\r\n/**\r\n * Validate NFE.io API key format\r\n * \r\n * @description\r\n * Performs basic validation on API key format before attempting to use it.\r\n * Helps catch common mistakes like missing keys or keys with whitespace.\r\n * \r\n * @param apiKey - The API key to validate\r\n * @returns Validation result with any detected issues\r\n * \r\n * @example\r\n * ```typescript\r\n * const result = validateApiKeyFormat('my-api-key');\r\n * if (!result.valid) {\r\n *   console.error('API key issues:', result.issues);\r\n *   // [\"API key appears to be too short\"]\r\n * }\r\n * ```\r\n * \r\n * @example Integration with client\r\n * ```typescript\r\n * const apiKey = process.env.NFE_API_KEY;\r\n * const validation = validateApiKeyFormat(apiKey);\r\n * \r\n * if (!validation.valid) {\r\n *   throw new Error(`Invalid API key: ${validation.issues.join(', ')}`);\r\n * }\r\n * \r\n * const nfe = new NfeClient({ apiKey });\r\n * ```\r\n */\r\nexport function validateApiKeyFormat(apiKey: string): {\r\n  /** Whether the API key passes basic validation */\r\n  valid: boolean;\r\n  /** List of validation issues found */\r\n  issues: string[];\r\n} {\r\n  const issues: string[] = [];\r\n  \r\n  if (!apiKey) {\r\n    issues.push('API key is required');\r\n  } else {\r\n    if (apiKey.length < 10) {\r\n      issues.push('API key appears to be too short');\r\n    }\r\n    \r\n    if (apiKey.includes(' ')) {\r\n      issues.push('API key should not contain spaces');\r\n    }\r\n    \r\n    // Add more validation rules as needed\r\n  }\r\n  \r\n  return {\r\n    valid: issues.length === 0,\r\n    issues,\r\n  };\r\n}"]}